<!DOCTYPE html>
<!-- saved from url=(0070)https://programmingelectronics.com/arduino-controlled-battery-charger/ -->
<html lang="en-US" class=" gr__programmingelectronics_com"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link rel="profile" href="https://gmpg.org/xfn/11">
<title>Building my First Arduino Controlled Battery Charger :: Student Project - Programming Electronics Academy</title>
			
			<!-- Facebook Pixel Code -->
			<script type="text/javascript" async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/js"></script><script type="text/javascript" async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/f.txt"></script><script async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/analytics.js.descarga"></script><script async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/fbevents.js.descarga"></script><script>
			!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
			n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
			n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
			t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
			document,'script','https://connect.facebook.net/en_US/fbevents.js');
			fbq('init', '518571721676816',  );			fbq('track', 'PageView');
			
			</script>
			<noscript><img height="1" width="1" style="display:none"
			src="https://www.facebook.com/tr?id=518571721676816&ev=PageView&noscript=1"
			/></noscript>
			<!-- DO NOT MODIFY -->
			<!-- End Facebook Pixel Code -->
			
			
<!-- This site is optimized with the Yoast SEO plugin v11.4 - https://yoast.com/wordpress/plugins/seo/ -->
<meta name="description" content="Want to build an Arduino Controlled Battery Charger?  This guy did it, and tells how he managed!">
<link rel="canonical" href="https://programmingelectronics.com/arduino-controlled-battery-charger/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Building my First Arduino Controlled Battery Charger :: Student Project - Programming Electronics Academy">
<meta property="og:description" content="Want to build an Arduino Controlled Battery Charger?  This guy did it, and tells how he managed!">
<meta property="og:url" content="https://programmingelectronics.com/arduino-controlled-battery-charger/">
<meta property="og:site_name" content="Programming Electronics Academy">
<meta property="article:section" content="Customer Projects">
<meta property="article:published_time" content="2016-01-01T10:00:51+00:00">
<meta property="article:modified_time" content="2016-11-10T16:25:44+00:00">
<meta property="og:updated_time" content="2016-11-10T16:25:44+00:00">
<meta property="og:image" content="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2016/01/Thumbnail-Roalnd-Battery-Charger-OP.jpg">
<meta property="og:image:secure_url" content="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2016/01/Thumbnail-Roalnd-Battery-Charger-OP.jpg">
<meta property="og:image:width" content="720">
<meta property="og:image:height" content="405">
<script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://programmingelectronics.com/#organization","name":"","url":"https://programmingelectronics.com/","sameAs":[]},{"@type":"WebSite","@id":"https://programmingelectronics.com/#website","url":"https://programmingelectronics.com/","name":"Programming Electronics Academy","publisher":{"@id":"https://programmingelectronics.com/#organization"},"potentialAction":{"@type":"SearchAction","target":"https://programmingelectronics.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"WebPage","@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#webpage","url":"https://programmingelectronics.com/arduino-controlled-battery-charger/","inLanguage":"en-US","name":"Building my First Arduino Controlled Battery Charger :: Student Project - Programming Electronics Academy","isPartOf":{"@id":"https://programmingelectronics.com/#website"},"image":{"@type":"ImageObject","@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#primaryimage","url":"https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2016/01/Thumbnail-Roalnd-Battery-Charger-OP.jpg","width":720,"height":405,"caption":"Arduino Controlled Battery Charger Student Project"},"primaryImageOfPage":{"@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#primaryimage"},"datePublished":"2016-01-01T10:00:51+00:00","dateModified":"2016-11-10T16:25:44+00:00","description":"Want to build an Arduino Controlled Battery Charger? \u00a0This guy did it, and tells how he managed!"},{"@type":"Article","@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#article","isPartOf":{"@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#webpage"},"author":{"@id":"https://programmingelectronics.com/author/oshj/#author"},"headline":"Building my First Arduino Controlled Battery Charger :: Student Project","datePublished":"2016-01-01T10:00:51+00:00","dateModified":"2016-11-10T16:25:44+00:00","commentCount":"13","mainEntityOfPage":{"@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#webpage"},"publisher":{"@id":"https://programmingelectronics.com/#organization"},"image":{"@id":"https://programmingelectronics.com/arduino-controlled-battery-charger/#primaryimage"},"articleSection":"Customer Projects"},{"@type":["Person"],"@id":"https://programmingelectronics.com/author/oshj/#author","name":"Michael James","image":{"@type":"ImageObject","@id":"https://programmingelectronics.com/#authorlogo","url":"https://secure.gravatar.com/avatar/108182d6b4ab8ecc56fe5593e3034d0a?s=96&d=wp_user_avatar&r=g","caption":"Michael James"},"sameAs":[]}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://fonts.googleapis.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link href="https://fonts.gstatic.com/" crossorigin="" rel="preconnect">
<link rel="alternate" type="application/rss+xml" title="Programming Electronics Academy » Feed" href="https://programmingelectronics.com/feed/">
<link rel="alternate" type="application/rss+xml" title="Programming Electronics Academy » Comments Feed" href="https://programmingelectronics.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Programming Electronics Academy » Building my First Arduino Controlled Battery Charger :: Student Project Comments Feed" href="https://programmingelectronics.com/arduino-controlled-battery-charger/feed/">
<style>.monsterinsights-async-hide { opacity: 0 !important} </style>
<script>(function(a,s,y,n,c,h,i,d,e){s.className+=' '+y;h.start=1*new Date;
h.end=i=function(){s.className=s.className.replace(RegExp(' ?'+y),'')};
(a[n]=a[n]||[]).hide=h;setTimeout(function(){i();h.end=null},c);h.timeout=c;
})(window,document.documentElement,'monsterinsights-async-hide','dataLayer',4000,
{'GTM-5FW677D':true});</script>
        <!-- This site uses the Google Analytics by MonsterInsights plugin v7.6.1 - Using Analytics tracking - https://www.monsterinsights.com/ -->
<script type="text/javascript" data-cfasync="false">
	var mi_version         = '7.6.1';
	var mi_track_user      = true;
	var mi_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-67322906-1';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}
	
	if ( mi_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

window.ga = __gaTracker;		__gaTracker('create', 'UA-67322906-1', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('set', 'anonymizeIp', true);
		__gaTracker('require', 'displayfeatures');
		__gaTracker('require', 'GTM-5FW677D');
		__gaTracker('send','pageview');
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + mi_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
			window.ga = __gaTracker;		})();
		}
</script>
<!-- / Google Analytics by MonsterInsights -->
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/programmingelectronics.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/wp-emoji-release.min.js.descarga" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="ezas-css-frontend-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/ezas-frontend.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-arduino-pea-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/arduino-pea.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/style.min.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-theme-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/theme.min.css" type="text/css" media="all">
<link rel="stylesheet" id="popupally-pro-style-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1-popupally-pro-style.css" type="text/css" media="all">
<link rel="stylesheet" id="fl-builder-layout-bundle-d420455c82b9836de199eb8956d80088-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/d420455c82b9836de199eb8956d80088-layout-bundle.css" type="text/css" media="all">
<link rel="stylesheet" id="jquery-magnificpopup-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery.magnificpopup.min.css" type="text/css" media="all">
<link rel="stylesheet" id="bootstrap-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/bootstrap.min.css" type="text/css" media="all">
<link rel="stylesheet" id="fl-automator-skin-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/skin-5d03c90ede01f.css" type="text/css" media="all">
<link rel="stylesheet" id="fl-child-theme-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="fl-builder-google-fonts-7fc65866cb1e1bb9db172e57c9104ba8-css" href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/css" type="text/css" media="all">
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery-migrate.min.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/programmingelectronics.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/crayon.min.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var monsterinsights_frontend = {"js_events_tracking":"true","download_extensions":"doc,exe,js,pdf,ppt,tgz,zip,xls","inbound_paths":"[]","home_url":"https:\/\/programmingelectronics.com","hash_tracking":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/frontend.min.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var popupally_pro_check_source_object = {"utm_mapping":{"popupally-cookie-4":"","popupally-cookie-5":"","popupally-cookie-6":"","popupally-cookie-7":"","popupally-cookie-9":"","popupally-cookie-10":""}};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/check-source.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1-popupally-pro-code.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var popupally_pro_action_object = {"ajax_url":"https:\/\/programmingelectronics.com\/wp-admin\/admin-ajax.php","submit_nonce":"def50f0f46","val_nonce":"aeb4b28ae0","popup_param":{"4":{"id":4,"cookie-duration":7,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"always","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-4","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-4","popup-class":"popupally-pro-opened-pro-gfcr-4","cookie-name":"popupally-cookie-4","close-trigger":".popup-click-close-trigger-4","test":4},"5":{"id":5,"cookie-duration":14,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"always","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-5","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-5","popup-class":"popupally-pro-opened-pro-gfcr-5","cookie-name":"popupally-cookie-5","close-trigger":".popup-click-close-trigger-5","test":5},"6":{"id":6,"open-trigger":"[href$=\"popup-click-open-trigger-6\"], [href$=\"popup-click-open-trigger-6\"] *, [href$=\"popup-click-open-trigger-6\/\"], [href$=\"popup-click-open-trigger-6\/\"] *","cookie-duration":14,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"always","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-6","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-6","popup-class":"popupally-pro-opened-pro-gfcr-6","cookie-name":"popupally-cookie-6","close-trigger":".popup-click-close-trigger-6","test":6},"7":{"id":7,"timed-popup-delay":60,"enable-exit-intent-popup":"true","enable-scroll-popup":"true","scroll-percent":50,"scroll-trigger":"","cookie-duration":1,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"always","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-7","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-7","popup-class":"popupally-pro-opened-pro-gfcr-7","cookie-name":"popupally-cookie-7","close-trigger":".popup-click-close-trigger-7","test":7},"9":{"id":9,"cookie-duration":7,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"never","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-9","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-9","popup-class":"popupally-pro-opened-pro-gfcr-9","cookie-name":"popupally-cookie-9","close-trigger":".popup-click-close-trigger-9","test":9},"10":{"id":10,"cookie-duration":14,"priority":0,"fade-in":"0","select-signup-type-popup":"thank-you","select-popup-after-popup":"0","select-signup-type-embed":"thank-you","select-popup-after-embed":"0","select-popup-embed-after-embed":"0","select-existing-subscribers-embed":"always","disable-mobile":"false","disable-desktop":"false","select-animation":"fade","popup-selector":"#popup-box-pro-gfcr-10","embedded-popup-selector":"#popup-embedded-box-pro-gfcr-10","popup-class":"popupally-pro-opened-pro-gfcr-10","cookie-name":"popupally-cookie-10","close-trigger":".popup-click-close-trigger-10","test":10}},"split_test":{"active":[],"variates":[]},"disable_track":"false"};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/popup.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/imagesloaded.min.js.descarga"></script>
<link rel="https://api.w.org/" href="https://programmingelectronics.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://programmingelectronics.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://programmingelectronics.com/?p=5697">
<link rel="alternate" type="application/json+oembed" href="https://programmingelectronics.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fprogrammingelectronics.com%2Farduino-controlled-battery-charger%2F">
<link rel="alternate" type="text/xml+oembed" href="https://programmingelectronics.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fprogrammingelectronics.com%2Farduino-controlled-battery-charger%2F&amp;format=xml">
<meta name="sitelock-site-verification" content="1104"><link rel="pingback" href="https://programmingelectronics.com/xmlrpc.php">
<link rel="icon" href="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/cropped-PEA_Gear-3-32x32.png" sizes="32x32">
<link rel="icon" href="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/cropped-PEA_Gear-3-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/cropped-PEA_Gear-3-180x180.png">
<meta name="msapplication-TileImage" content="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/09/cropped-PEA_Gear-3-270x270.png">
		<style type="text/css" id="wp-custom-css">
			/* Headings */
h1, h3 {
	font-family: 'Pathway Gothic One', sans-serif;
	color: #154F74;
	font-weight: 400;
}
/* Header */
#menu-main-menu a {
	letter-spacing: 1.2px;
	text-align: left;
}
.sub-menu {
	border-top: 3px solid #ef7422;
}
.pea-access-link,
.pea-top-bar-text {
	font-family : Pathway Gothic One, sans-serif;
	font-size: 18px;
	letter-spacing : 1.2px;
	text-transform: uppercase;
}
.pea-top-bar-text {
	margin-top: 5px !important;
	margin-bottom: 5px;
}
.pea-access-link:hover {
	text-decoration: none;
}

@media (max-width: 768px) {
	#pea-header-access-login p {
		text-align: center !important;
	}
}
@media screen and (min-width:768px) {
  #pea-header-menu-row #pea-logo-img {
	  margin-top: -35px;
  }
}

/* Mobile Menu */
@media (max-width: 767px) {
	.fl-menu-mobile-toggle {
		background-color: #EF7422 !important;
		color: #fff !important;
		border-radius: 25px !important;
	}
	.fl-menu-responsive-toggle-mobile a {
		text-align: center !important;
	}
	.fl-module-menu .fl-module-content {
    margin-left: 20px !important;
	  margin-right: 20px !important;
  }
}


/* Fonts */
p {
	margin-bottom: 28px;
}

/* Footer */
#menu-footer-menu a {
	letter-spacing: 1.2px;
	text-align: center;
}
.pea-copyright {
	font-family : Pathway Gothic One, sans-serif;
	text-transform: uppercase;
	text-align: center;
	letter-spacing: 1.2px
}
.pea-copyright a:hover {
	text-decoration: none;
}
.pea-logo-home {
	height: 150px;
}
.pea-logo-home2 {
	height: 80px;
}
.pea-logo-heading {
	height: 100px;
}
.fl-node-5b369763294f0 {
	border-right: solid 1px #154F74;
}
@media (max-width: 1640px) {
	#footer-triangle-row .fl-row-content-wrap {
		padding-top: 80px;
		padding-bottom: 0px;
	}
}
@media (min-width: 1641px) {
	#freearduino-header-row .fl-row-content-wrap {
		background-image: url('https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/PE_HP_BKGD-short.png');
	}
	#tutorials-header-row .fl-row-content-wrap {
		background-image: url('https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/PE_HP_BKGD-short.png');
	}
}
@media (min-width: 1641px) {
	#footer-triangle-row .fl-row-content-wrap {
		background-image: url('https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/PE_BKGDFooter-short.png');
	}
}
@media (max-width: 768px) {
	.pea-logo-home {
		height: auto;
	}	
	.fl-node-5b369763294f0 {
		border-right: none;
	}
}

/* Buttons & Links */
.fl-button {
	border: none !important;
}
.fl-button-text {
	text-transform: uppercase;
	font-family: 'Poppins', sans-serif;
}
.pea-big-link {
	font-family : Poppins, sans-serif;
  font-weight : bold;
  font-size : 24px;
  letter-spacing : 0.63px;
  text-transform : uppercase;
  color : #EF8822;
	text-decoration: underline;
}
.pea-button,
.pea-button-big {
	font-family: Poppins, sans-serif;
	color: #fff;
	background: #EF7422;
	text-transform: uppercase;
	border-radius: 25px;
	font-size: 16px;
	padding: 12px 24px;
	font-weight: 400;
}
.pea-button i {
	font-size: 20.8px;
}
.pea-button:hover,
.pea-button-big:hover{
	background: #8FC4D1;
	color: #fff;
	text-decoration: none;
}
.pea-button-big {
	font-size: 24px;
	font-weight: 700;
	line-height: 26px;
	padding: 9px 24px;
}
/* Home page */
@media (max-width: 1920px) {
	#home-header-row .fl-row-content-wrap {
		padding-top: 90px;
		padding-bottom: 90px;
	}
}
#pea-banner-title-1 {
	font-family : Pathway Gothic One, sans-serif;
  font-size : 105px;
  text-transform : uppercase;
  color : #FFFFFF;
	line-height: 130px;
}
@media (max-width: 768px) {
	#pea-banner-title-1 {
		font-size : 70px;
		line-height: 90px;
	}
}
#pea-banner-title-2 {
	font-family : Pathway Gothic One;
  font-size : 42px;
  text-transform : uppercase;
  color : #FFFFFF;
}
.pea-blurb p {
	font-size: 22px;
	margin-bottom: 28px;
	line-height: 40px;
}
.pea-orange-blurb p {
	font-size: 22px;
	text-transform: uppercase;
	color: #ef7422;
	font-weight: bold;
	text-align: center;
	letter-spacing: 1.2px;
}
.pea-orange {
	font-size: 22px;
	text-transform: uppercase;
	color: #ef7422;
	font-weight: bold;
	letter-spacing: 1.2px;
}
.pea-blue-blurb p {
	font-size: 22px;
	margin-bottom: 28px;
	text-transform: uppercase;
	color: #0384A3;
	font-weight: bold;
	letter-spacing: 1.2px;
}
.pea-orange-blurb a:hover {
	text-decoration: none;
}

.pea-sig-title p {
	text-transform: uppercase;
	font-size: 16px;
}
.pea-shadow-row,
.pea-shadow-col,
.pea-shadow-col-left,
.pea-shadow-col-right {
	-webkit-box-shadow: 0 0 20px #efefef;
        box-shadow: 0 0 20px #cccccc;
}
.pea-shadow-col {
	width: 30%;
	margin: 10px;
}
.pea-shadow-col-left {
	width: 30%;
	margin: 10px 10px 10px 0;
}
.pea-shadow-col-right {
	width: 30%;
	margin: 10px 0px 10px 10px;
}
.pea-box-heading {
	font-size : 26px;
	line-height : 36px;
  letter-spacing : 1px;
}

/* Pricing Page */
/* List styling */
.pea-pricing-list, .pea-pricing-list ul {
  margin-top: 0;
  padding-left: 2em;
  list-style-type: none;
}
.pea-pricing-list li:before {
  position: absolute;
  margin-left: -1.3em;
  font-weight: bold;
}
.pea-pricing-list li.tick:before {
  content: "\2713";
  color: darkgreen;
}
.pea-pricing-list li.cross:before {
  content: "\2717";
  color: crimson;
}
.pea-blurb-col .pea-blurb {
	min-height: 488px;
}
.pea-pricing-body-col .pea-blurb {
	min-height: 550px;
}
.pea-pricing-desc-col .pea-blurb {
	min-height: 254px;
}
.fl-accordion-button {
	background: #0384a3;
}
.fl-accordion-button-label {
	color: #fff;
	font-weight: bold;
	text-transform: uppercase;
}
.fl-accordion-button-icon {
	color: #fff;
	opacity:1;
}
.fl-accordion-content {
	background: rgba(143, 196,209,0.25);
	padding-top: 40px !important;
}
.fl-accordion-content p {
	font-size: 22px;
	margin-bottom: 28px;
	line-height: 40px;
}
 .pea-vertical-spacer-300 {
	  height: 300px;
 }

@media (max-width: 768px) {
  .pea-vertical-spacer-300 {
	  display:none;
  }
  .pea-pricing-col {
		margin-top: 20px;
	}
}
@media (min-width: 767px) and (max-width: 1920px) {
	#pea-pricing-header-row .fl-row-content-wrap {
		padding-top: 50px;
		padding-bottom: 90px;
	}

	.pea-blurb-col .pea-blurb {
    min-height: 500px;
	}
	.pea-pricing-body-col .pea-blurb {
    min-height: 550px;
  }
	.pea-pricing-desc-col .pea-blurb {
    min-height: 290px;
  }
}
@media (min-width: 1641px) {
	#pea-pricing-relate-row .fl-row-content-wrap {
		background-image: url('https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/PE_BKGD-Down-950.png');
	}
}
@media (min-width: 1641px) {
	#pea-pricing-guarantee-row .fl-row-content-wrap {
		background-image: url('https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/07/Pricing_BFGD-700.png');
	}
}
@media (max-width: 768px) {
	.pea-blurb-col .pea-blurb {
    min-height: 0;
	}
}

/* column stacking customization */
.column-max-width .fl-col-content {
	max-width: 700px;
}
.image-cover {
	height: 100%;
}
.image-cover * {
	height: 100% !important;
	object-fit: cover;
}

/* embedded popup Arduino Tutorials */
#popup-embedded-box-pro-gfcr-2.popupally-pro-outer-embedded-gfcr-2 {
	margin: 0 0 !important;
}
#popup-embedded-box-pro-gfcr-2 .popupally-pro-inner-pro-gfcr-2 {
	padding: 20px 20px 20px 0 !important;
}

/* Videos */
.pea-video {
	border: 15px solid white;
  box-shadow: 0 0 20px #666;
}

/* PopupAlly Pro */
#popup-embedded-box-pro-gfcr-5 {
	margin: auto;
}		</style>
		<style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><style id="PDFTStyle" type="text/css">.qtip-content { font-family: "Times New Roman"; font-size: 17px; line-height: 19px;} .qtip-max-width { max-width: 300px; }</style><style type="text/css">.fomo-notification.fomo-notification-animation-fade-in{-webkit-animation:fomoFadeIn 1s;-o-animation:fomoFadeIn 1s;animation:fomoFadeIn 1s;-webkit-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both}.fomo-notification.fomo-notification-animation-fade-out{-webkit-animation:fomoFadeOut 1s;-o-animation:fomoFadeOut 1s;animation:fomoFadeOut 1s;-webkit-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both}.fomo-notification.fomo-notification-animation-horizontal,.fomo-notification.fomo-notification-animation-vertical{-webkit-animation-fill-mode:forwards;-o-animation-fill-mode:forwards;animation-fill-mode:forwards}@-webkit-keyframes fomoFadeIn{0%{opacity:0}to{opacity:1}}@-o-keyframes fomoFadeIn{0%{opacity:0}to{opacity:1}}@keyframes fomoFadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fomoFadeOut{0%{opacity:1}to{opacity:0}}@-o-keyframes fomoFadeOut{0%{opacity:1}to{opacity:0}}@keyframes fomoFadeOut{0%{opacity:1}to{opacity:0}}@-webkit-keyframes fomoSlideOutHorizontalLeft{to{opacity:0;-webkit-transform:translateX(-200%);transform:translateX(-200%)}}@-o-keyframes fomoSlideOutHorizontalLeft{to{opacity:0;-o-transform:translateX(-200%);transform:translateX(-200%)}}@keyframes fomoSlideOutHorizontalLeft{to{opacity:0;-webkit-transform:translateX(-200%);-o-transform:translateX(-200%);transform:translateX(-200%)}}@-webkit-keyframes fomoSlideInHorizontalRight{to{opacity:1;-webkit-transform:translateX(0);transform:translateX(0)}}@-o-keyframes fomoSlideInHorizontalRight{to{opacity:1;-o-transform:translateX(0);transform:translateX(0)}}@keyframes fomoSlideInHorizontalRight{to{opacity:1;-webkit-transform:translateX(0);-o-transform:translateX(0);transform:translateX(0)}}@-webkit-keyframes fomoSlideOutHorizontalRight{to{opacity:0;-webkit-transform:translateX(200%);transform:translateX(200%)}}@-o-keyframes fomoSlideOutHorizontalRight{to{opacity:0;-o-transform:translateX(200%);transform:translateX(200%)}}@keyframes fomoSlideOutHorizontalRight{to{opacity:0;-webkit-transform:translateX(200%);-o-transform:translateX(200%);transform:translateX(200%)}}@-webkit-keyframes fomoSlideOutVerticalBottom{to{opacity:1;-webkit-transform:translateY(200%);transform:translateY(200%)}}@-o-keyframes fomoSlideOutVerticalBottom{to{opacity:1;-o-transform:translateY(200%);transform:translateY(200%)}}@keyframes fomoSlideOutVerticalBottom{to{opacity:1;-webkit-transform:translateY(200%);-o-transform:translateY(200%);transform:translateY(200%)}}@-webkit-keyframes fomoSlideOutVerticalBottomCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(200%);transform:translateX(-50%) translateY(200%)}}@-o-keyframes fomoSlideOutVerticalBottomCenter{to{opacity:1;-o-transform:translateX(-50%) translateY(200%);transform:translateX(-50%) translateY(200%)}}@keyframes fomoSlideOutVerticalBottomCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(200%);-o-transform:translateX(-50%) translateY(200%);transform:translateX(-50%) translateY(200%)}}@-webkit-keyframes fomoSlideInVerticalTop{to{opacity:1;-webkit-transform:translateY(0);transform:translateY(0)}}@-o-keyframes fomoSlideInVerticalTop{to{opacity:1;-o-transform:translateY(0);transform:translateY(0)}}@keyframes fomoSlideInVerticalTop{to{opacity:1;-webkit-transform:translateY(0);-o-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes fomoSlideOutVerticalTop{to{opacity:1;-webkit-transform:translateY(-200%);transform:translateY(-200%)}}@-o-keyframes fomoSlideOutVerticalTop{to{opacity:1;-o-transform:translateY(-200%);transform:translateY(-200%)}}@keyframes fomoSlideOutVerticalTop{to{opacity:1;-webkit-transform:translateY(-200%);-o-transform:translateY(-200%);transform:translateY(-200%)}}@-webkit-keyframes fomoSlideInVerticalTopCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}@-o-keyframes fomoSlideInVerticalTopCenter{to{opacity:1;-o-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}@keyframes fomoSlideInVerticalTopCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(0);-o-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0)}}@-webkit-keyframes fomoSlideOutVerticalTopCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(-200%);transform:translateX(-50%) translateY(-200%)}}@-o-keyframes fomoSlideOutVerticalTopCenter{to{opacity:1;-o-transform:translateX(-50%) translateY(-200%);transform:translateX(-50%) translateY(-200%)}}@keyframes fomoSlideOutVerticalTopCenter{to{opacity:1;-webkit-transform:translateX(-50%) translateY(-200%);-o-transform:translateX(-50%) translateY(-200%);transform:translateX(-50%) translateY(-200%)}}.fomo-notification.fomo-notification-position-bottom-left,.fomo-notification.fomo-notification-position-top-left{-webkit-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s}.fomo-notification.fomo-notification-position-bottom-left.fomo-notification-animation-horizontal.fomo-notification-show,.fomo-notification.fomo-notification-position-top-left.fomo-notification-animation-horizontal.fomo-notification-show{-webkit-transform:translateX(-200%);-ms-transform:translateX(-200%);-o-transform:translateX(-200%);transform:translateX(-200%);opacity:0;-webkit-animation-name:fomoSlideInHorizontalRight;-o-animation-name:fomoSlideInHorizontalRight;animation-name:fomoSlideInHorizontalRight}.fomo-notification.fomo-notification-position-bottom-left.fomo-notification-animation-horizontal.fomo-notification-hide,.fomo-notification.fomo-notification-position-top-left.fomo-notification-animation-horizontal.fomo-notification-hide{-webkit-animation-name:fomoSlideOutHorizontalLeft;-o-animation-name:fomoSlideOutHorizontalLeft;animation-name:fomoSlideOutHorizontalLeft}.fomo-notification.fomo-notification-position-bottom-left.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateY(200%);-ms-transform:translateY(200%);-o-transform:translateY(200%);transform:translateY(200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-position-bottom-left.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-animation-name:fomoSlideOutVerticalBottom;-o-animation-name:fomoSlideOutVerticalBottom;animation-name:fomoSlideOutVerticalBottom}.fomo-notification.fomo-notification-position-top-left{bottom:auto;top:20px}.fomo-notification.fomo-notification-position-top-left.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateY(-200%);-ms-transform:translateY(-200%);-o-transform:translateY(-200%);transform:translateY(-200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-position-top-left.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-animation-name:fomoSlideOutVerticalTop;-o-animation-name:fomoSlideOutVerticalTop;animation-name:fomoSlideOutVerticalTop}.fomo-notification.fomo-notification-position-bottom-right,.fomo-notification.fomo-notification-position-top-right{-webkit-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s}.fomo-notification.fomo-notification-position-bottom-right.fomo-notification-animation-horizontal.fomo-notification-show,.fomo-notification.fomo-notification-position-top-right.fomo-notification-animation-horizontal.fomo-notification-show{-webkit-transform:translateX(200%);-ms-transform:translateX(200%);-o-transform:translateX(200%);transform:translateX(200%);opacity:0;-webkit-animation-name:fomoSlideInHorizontalRight;-o-animation-name:fomoSlideInHorizontalRight;animation-name:fomoSlideInHorizontalRight}.fomo-notification.fomo-notification-position-bottom-right.fomo-notification-animation-horizontal.fomo-notification-hide,.fomo-notification.fomo-notification-position-top-right.fomo-notification-animation-horizontal.fomo-notification-hide{-webkit-animation-name:fomoSlideOutHorizontalRight;-o-animation-name:fomoSlideOutHorizontalRight;animation-name:fomoSlideOutHorizontalRight}.fomo-notification.fomo-notification-position-top-right{right:20px;top:20px;left:auto;bottom:auto}.fomo-notification.fomo-notification-position-top-right.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateY(-200%);-ms-transform:translateY(-200%);-o-transform:translateY(-200%);transform:translateY(-200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-position-top-right.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-animation-name:fomoSlideOutVerticalTop;-o-animation-name:fomoSlideOutVerticalTop;animation-name:fomoSlideOutVerticalTop}.fomo-notification.fomo-notification-position-bottom-right{right:20px;left:auto}.fomo-notification.fomo-notification-position-bottom-right.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateY(200%);-ms-transform:translateY(200%);-o-transform:translateY(200%);transform:translateY(200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-position-bottom-right.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-animation-name:fomoSlideOutVerticalBottom;-o-animation-name:fomoSlideOutVerticalBottom;animation-name:fomoSlideOutVerticalBottom}.fomo-notification.fomo-notification-position-bottom-center{left:50%!important;-webkit-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s}.fomo-notification.fomo-notification-position-bottom-center.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateX(-50%) translateY(200%);-ms-transform:translateX(-50%) translateY(200%);-o-transform:translateX(-50%) translateY(200%);transform:translateX(-50%) translateY(200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTopCenter;-o-animation-name:fomoSlideInVerticalTopCenter;animation-name:fomoSlideInVerticalTopCenter}.fomo-notification.fomo-notification-position-bottom-center.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-transform:translateX(-50%) translateY(0);-ms-transform:translateX(-50%) translateY(0);-o-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0);-webkit-animation-name:fomoSlideOutVerticalBottomCenter;-o-animation-name:fomoSlideOutVerticalBottomCenter;animation-name:fomoSlideOutVerticalBottomCenter}.fomo-notification.fomo-notification-position-top-center{bottom:auto;top:20px;left:50%!important;-webkit-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s}.fomo-notification.fomo-notification-position-top-center.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateX(-50%) translateY(-100%);-ms-transform:translateX(-50%) translateY(-100%);-o-transform:translateX(-50%) translateY(-100%);transform:translateX(-50%) translateY(-100%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTopCenter;-o-animation-name:fomoSlideInVerticalTopCenter;animation-name:fomoSlideInVerticalTopCenter}.fomo-notification.fomo-notification-position-top-center.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-transform:translateX(-50%) translateY(0);-ms-transform:translateX(-50%) translateY(0);-o-transform:translateX(-50%) translateY(0);transform:translateX(-50%) translateY(0);-webkit-animation-name:fomoSlideOutVerticalTopCenter;-o-animation-name:fomoSlideOutVerticalTopCenter;animation-name:fomoSlideOutVerticalTopCenter}@media only screen and (max-width:479px){.fomo-notification.fomo-notification-mobile-position-bottom,.fomo-notification.fomo-notification-mobile-position-top{width:calc(100% - 20px);left:10px!important}}@media only screen and (max-width:479px){.fomo-notification.fomo-notification-mobile-position-bottom{bottom:10px;top:auto}.fomo-notification.fomo-notification-mobile-position-bottom.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateY(200%);-ms-transform:translateY(200%);-o-transform:translateY(200%);transform:translateY(200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-mobile-position-bottom.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-transform:translateX(0) translateY(0);-ms-transform:translateX(0) translateY(0);-o-transform:translateX(0) translateY(0);transform:translateX(0) translateY(0);-webkit-animation-name:fomoSlideOutVerticalBottom;-o-animation-name:fomoSlideOutVerticalBottom;animation-name:fomoSlideOutVerticalBottom}}@media only screen and (max-width:479px){.fomo-notification.fomo-notification-mobile-position-top{top:10px;bottom:auto}.fomo-notification.fomo-notification-mobile-position-top.fomo-notification-animation-vertical.fomo-notification-show{-webkit-transform:translateX(0) translateY(-200%);-ms-transform:translateX(0) translateY(-200%);-o-transform:translateX(0) translateY(-200%);transform:translateX(0) translateY(-200%);opacity:0;-webkit-animation-name:fomoSlideInVerticalTop;-o-animation-name:fomoSlideInVerticalTop;animation-name:fomoSlideInVerticalTop}.fomo-notification.fomo-notification-mobile-position-top.fomo-notification-animation-vertical.fomo-notification-hide{-webkit-transform:translateX(0) translateY(0);-ms-transform:translateX(0) translateY(0);-o-transform:translateX(0) translateY(0);transform:translateX(0) translateY(0);-webkit-animation-name:fomoSlideOutVerticalTop;-o-animation-name:fomoSlideOutVerticalTop;animation-name:fomoSlideOutVerticalTop}}@media only screen and (max-width:479px){.fomo-notification.fomo-notification-mobile-position-top.fomo-notification-ad{top:20px}}.fomo-notification .fomo-animation-count-up{display:none;font-variant-numeric:tabular-nums}@-webkit-keyframes fomo-animation-tada{0%{-webkit-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}@-o-keyframes fomo-animation-tada{0%{-o-transform:scale(1);transform:scale(1)}10%,20%{-o-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-o-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-o-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-o-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}@keyframes fomo-animation-tada{0%{-webkit-transform:scale(1);-o-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);-o-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);-o-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);-o-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);-o-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}.fomo-notification .fomo-animation-tada{-webkit-animation-name:fomo-animation-tada;-o-animation-name:fomo-animation-tada;animation-name:fomo-animation-tada;-webkit-animation-duration:1s;-o-animation-duration:1s;animation-duration:1s;-webkit-animation-delay:1s;-o-animation-delay:1s;animation-delay:1s;-webkit-animation-fill-mode:both;-o-animation-fill-mode:both;animation-fill-mode:both;display:inline-block}.fomo-notification{display:none;width:320px;border:0;bottom:20px;left:20px;position:fixed;text-align:left;z-index:99999;font-family:National,arial,sans-serif;-webkit-box-sizing:border-box;box-sizing:border-box;font-weight:400;border-radius:6px;-webkit-box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);background-color:#fff}.fomo-notification:hover #fomo-close{opacity:.8;visibility:visible}.fomo-notification *,.fomo-notification :after,.fomo-notification :before{-webkit-box-sizing:border-box;box-sizing:border-box}.fomo-notification .fomo-notification-powered-by{margin-top:3px!important;display:block!important;font-size:10px!important;color:#474ba5;opacity:.5;position:absolute;bottom:3px;right:6px;font-size:10px;vertical-align:bottom}.fomo-notification .fomo-notification-ad-by{display:none;visibility:hidden}.fomo-notification .fomo-notification-ad-by a,.fomo-notification .fomo-notification-ad-by a:hover{text-decoration:none;cursor:pointer}.fomo-notification.fomo-notification-ad{z-index:2147483647}.fomo-notification.fomo-notification-ad .fomo-notification-ad-by{margin:0;display:block!important;visibility:visible;font-size:12px!important;position:absolute;top:-24px!important;left:2px}.fomo-notification .fomo-notification-container{display:table!important;display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:80px}.fomo-notification .fomo-notification-content-wrapper{margin:0;height:100%;color:gray;padding-left:20px;padding-right:20px;border-radius:0 6px 6px 0;-webkit-box-flex:1;-ms-flex:1;flex:1;display:table-cell!important;display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;vertical-align:middle}.fomo-notification .fomo-notification-content-wrapper .fomo-notification-content{font-family:inherit!important;margin:0!important;padding:0!important;font-size:16px;line-height:16px}.fomo-notification .fomo-notification-content-wrapper .fomo-notification-content-info{display:block!important}.fomo-notification .fomo-notification-content-wrapper a{color:inherit;font-weight:700!important;text-decoration:none!important}.fomo-notification .fomo-notification-content-wrapper .fomo-notification-powered-by,.fomo-notification .fomo-notification-content-wrapper small{margin-top:3px!important;display:block!important;font-size:10px!important;opacity:.5}.fomo-notification .fomo-notification-content-wrapper small{margin-right:6px;vertical-align:middle}.fomo-notification .fomo-notification-content-wrapper .fomo-notification-powered-by{font-size:10px;vertical-align:bottom}.fomo-notification .fomo-notification-image-wrapper{height:80px;width:80px;overflow:hidden;display:table-cell!important;display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;vertical-align:middle;border-radius:6px 0 0 6px;text-align:center}.fomo-notification .fomo-notification-image-wrapper img{max-width:100%!important;width:auto;height:100%}.fomo-notification .fomo-notification-image-wrapper.fomo-notification-image-is-landscape img{position:relative;max-width:100%!important;width:auto;max-height:100%!important;height:auto}.fomo-notification .fomo-notification-image-wrapper-inside{height:100%;width:100%;overflow:hidden;display:-webkit-box!important;display:-ms-flexbox!important;display:flex!important;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-flex:1;-ms-flex:1;flex:1}.fomo-notification.fomo-notification-no-image .fomo-notification-image-wrapper{display:none!important}.fomo-notification.fomo-notification-pointer,.fomo-notification .fomo-notification-pointer{cursor:pointer}.fomo-notification #fomo-close{position:absolute;top:2px;right:2px;height:24px;width:24px;cursor:pointer;opacity:0;visibility:hidden;-webkit-transition:.2s ease-in-out;-o-transition:.2s ease-in-out;transition:.2s ease-in-out;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-o-transform:rotate(45deg);transform:rotate(45deg)}@media only screen and (max-width:479px){.fomo-notification #fomo-close{opacity:.8;visibility:visible}}.fomo-notification #fomo-close:before{width:12px;height:2px}.fomo-notification #fomo-close:after,.fomo-notification #fomo-close:before{content:"";display:block;background-color:gray;position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);-o-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.fomo-notification #fomo-close:after{height:12px;width:2px}.fomo-notification.fomo-notification-no-shadow{-webkit-box-shadow:none;box-shadow:none}.fomo-notification-no-image .fomo-notification-content-wrapper{padding-left:40px;padding-right:40px;border-radius:6px}.fomo-notification-font-lg.fomo-notification-no-image .fomo-notification-content-wrapper{padding-right:80px}.fomo-notification-font-md .fomo-notification-content-wrapper .fomo-notification-content{font-size:14px;line-height:14px}.fomo-notification-font-sm .fomo-notification-content-wrapper .fomo-notification-content{font-size:12px;line-height:14px}.fomo-notification-font-xs .fomo-notification-content-wrapper{padding-left:20px;padding-right:20px;margin-top:0}.fomo-notification-font-xs .fomo-notification-content-wrapper .fomo-notification-content{font-size:10px;line-height:12px}.fomo-notification-v2-gap{border-radius:0 6px 6px 0;width:340px;background:none}.fomo-notification-v2-gap.fomo-notification-no-image{width:320px}.fomo-notification-v2-gap .fomo-notification-content-wrapper{background:#fff}.fomo-notification-v2-gap:not(.fomo-notification-no-image){-webkit-box-shadow:none;box-shadow:none}.fomo-notification-v2-gap:not(.fomo-notification-no-image) .fomo-notification-content-wrapper{padding-left:20px;padding-right:20px;border-radius:0 6px 6px 0;-webkit-box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2)}.fomo-notification-v2-gap .fomo-notification-image-wrapper{-webkit-box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);box-shadow:2px 2px 10px 2px hsla(0,0%,60%,.2);margin-right:10px;background:#fff}.fomo-notification-v2-gap.fomo-notification-no-shadow .fomo-notification-content-wrapper,.fomo-notification-v2-gap.fomo-notification-no-shadow .fomo-notification-image-wrapper{-webkit-box-shadow:none;box-shadow:none}.fomo-notification-v2-gap {}</style><script async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/saved_resource"></script><script src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/f(1).txt"></script><script async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/geo_events.js.descarga"></script><script src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/track.php"></script></head>
<body class="post-template-default single single-post postid-5697 single-format-standard fl-theme-builder-header fl-theme-builder-footer fl-theme-builder-singular fl-framework-bootstrap fl-preset-default fl-full-width" itemscope="itemscope" itemtype="https://schema.org/WebPage" data-gr-c-s-loaded="true" data-hasqtip="0" data-op-tracked="true">
<!-- Global site tag (gtag.js) - Google Ads: 891860712 --> <script async="" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/js(1)"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'AW-891860712'); </script>
<script src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/tracking.js.descarga" type="text/javascript" async="true" onload="_mri=&quot;30397&quot;,_mr_domain=&quot;electronics.ontraport.com&quot;,mrtracking();"></script><div class="fl-page">
	<header class="fl-builder-content fl-builder-content-7973 fl-builder-global-templates-locked" data-post-id="7973" itemscope="itemscope" itemtype="http://schema.org/WPHeader" data-type="header" data-sticky="0" data-shrink="0" data-overlay="0" data-overlay-bg="transparent"><div id="pea-topbar-row" class="fl-row fl-row-full-width fl-row-bg-color fl-node-5b3645f07fc30 fl-visible-desktop-medium" data-node="5b3645f07fc30">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content">
		
<div class="fl-col-group fl-node-5b3645f07fc74 fl-col-group-equal-height fl-col-group-align-center" data-node="5b3645f07fc74">
			<div class="fl-col fl-node-5b3645f07fcb7 fl-col-has-cols" data-node="5b3645f07fcb7">
	<div class="fl-col-content fl-node-content">
	
<div class="fl-col-group fl-node-5b994c85817cd fl-col-group-nested" data-node="5b994c85817cd">
			<div class="fl-col fl-node-5b994c8581c05" data-node="5b994c8581c05">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-rich-text fl-node-5b3648837aa87" data-node="5b3648837aa87">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<p class="pea-top-bar-text" style="margin-top: 10px; text-align: right;">SALES INQUIRIES: 1 (888) 767-9864</p>
</div>
	</div>
</div>
	</div>
</div>
	</div>
	</div>
</div>
	</div>
		</div>
	</div>
</div>
<div id="pea-header-menu-row" class="fl-row fl-row-full-width fl-row-bg-color fl-node-5b3645f07fa5b" data-node="5b3645f07fa5b">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content" style="position: relative;">
		
<div class="fl-col-group fl-node-5b36474beddea" data-node="5b36474beddea">
			<div class="fl-col fl-node-5b36474bee0a7 fl-col-small" data-node="5b36474bee0a7">
	<div class="fl-col-content fl-node-content">
	<div id="pea-logo-img" class="fl-module fl-module-photo fl-node-5b364676a5cdc" data-node="5b364676a5cdc">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-jpg">
				<a href="https://programmingelectronics.com/home/" target="_self" itemprop="url">
				<img class="fl-photo-img wp-image-7956 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PEA-logo_150.jpg" alt="Programming Electronics Academy logo" itemprop="image" height="150" width="466" title="Programming Electronics Academy logo" data-no-lazy="1" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/PEA-logo_150.jpg 466w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/PEA-logo_150-300x97.jpg 300w" sizes="(max-width: 466px) 100vw, 466px">
				</a>
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b36474bee0ea" data-node="5b36474bee0ea">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-menu fl-node-5b3645f07fbec" data-node="5b3645f07fbec">
	<div class="fl-module-content fl-node-content">
		<div class="fl-menu fl-menu-responsive-toggle-mobile">
	<button class="fl-menu-mobile-toggle text"><span class="fl-menu-mobile-toggle-label" aria-label="Menu">Menu</span></button>	<div class="fl-clear"></div>
	<nav aria-label="Menu" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement"><ul id="menu-main-menu" class="menu fl-menu-horizontal fl-toggle-none"><li id="menu-item-8220" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children fl-has-submenu"><div class="fl-has-submenu-container"><a href="https://programmingelectronics.com/arduino-tutorials-2/">Free Resources</a><span class="fl-menu-toggle"></span></div><ul class="sub-menu">	<li id="menu-item-9192" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/programming-based/">Arduino Programming Lessons</a></li>	<li id="menu-item-9191" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/electronics-based/">Arduino Electronics Lessons</a></li>	<li id="menu-item-9193" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/project-based/">Arduino Project Lessons</a></li>	<li id="menu-item-9194" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/tools-based/">Arduino Tools</a></li>	<li id="menu-item-9195" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/pea-podcast/">PEA Podcast</a></li>	<li id="menu-item-9196" class="menu-item menu-item-type-custom menu-item-object-custom"><a href="https://programmingelectronics.com/category/student-project/">Member Projects</a></li></ul></li><li id="menu-item-8206" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/kit-shield-arduino-info/">Kit-on-a-Shield</a></li><li id="menu-item-8202" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children fl-has-submenu"><div class="fl-has-submenu-container"><a href="https://programmingelectronics.com/arduino-crash-course/">Premium Courses</a><span class="fl-menu-toggle"></span></div><ul class="sub-menu">	<li id="menu-item-9184" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/arduino-course-absolute-beginners-2nd-edition-info/">Arduino Course for Absolute Beginners</a></li>	<li id="menu-item-9185" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/lcds-servos-twitter4j-course-info/">LCDs, Servos, and Twitter4J Course</a></li>	<li id="menu-item-9186" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/internet-of-things-with-the-esp8266-course-info/">Internet of Things with the ESP8266</a></li>	<li id="menu-item-9187" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/basic-electronics-course-info/">Basic Electronics Course</a></li>	<li id="menu-item-9188" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/arduino-course-absolute-beginners-1st-edition-archive-info/">Arduino Course for Absolute Beginners 1st Ed</a></li>	<li id="menu-item-9189" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/arduino-course-absolute-beginners-ebook-info/">Arduino eBook</a></li>	<li id="menu-item-8207" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/pricing-archive/">*Join the Academy*</a></li></ul></li></ul></nav></div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b36474bee126 fl-col-small" data-node="5b36474bee126">
	<div class="fl-col-content fl-node-content">
	<div id="pea-header-access-login" class="fl-module fl-module-rich-text fl-node-5b36477328493" data-node="5b36477328493">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<p style="text-align: right;"><a class="pea-access-link" href="https://programmingelectronics.com/pricing/">Get Access</a> <a class="pea-access-link">/</a> <a class="pea-access-link" href="https://academy.programmingelectronics.com/" target="_blank" rel="noopener">Member Login</a></p>
</div>
	</div>
</div>
	</div>
</div>
	</div>
		</div>
	</div>
</div>
</header>	<div class="fl-page-content" itemprop="mainContentOfPage">

		<div class="fl-builder-content fl-builder-content-8379 fl-builder-global-templates-locked" data-post-id="8379"><div class="fl-row fl-row-fixed-width fl-row-bg-none fl-node-5ba1491146eb1" data-node="5ba1491146eb1">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content">
		
<div class="fl-col-group fl-node-5ba1491146eee" data-node="5ba1491146eee">
			<div class="fl-col fl-node-5ba1491146f2c" data-node="5ba1491146f2c">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-heading fl-node-5ba1491146c7b" data-node="5ba1491146c7b">
	<div class="fl-module-content fl-node-content">
		<h1 class="fl-heading">
		<span class="fl-heading-text">Building my First Arduino Controlled Battery Charger :: Student Project</span>
	</h1>
	</div>
</div>
	</div>
</div>
	</div>
		</div>
	</div>
</div>
<div class="fl-row fl-row-fixed-width fl-row-bg-none fl-node-5ba1491146b4a" data-node="5ba1491146b4a">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content">
		
<div class="fl-col-group fl-node-5ba1491146b9a" data-node="5ba1491146b9a">
			<div class="fl-col fl-node-5ba1491146be6" data-node="5ba1491146be6">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-fl-post-content fl-node-5ba1491146c3b" data-node="5ba1491146c3b">
	<div class="fl-module-content fl-node-content">
		<p><em>This project was built by one of our long time students, Roland. &nbsp;I am always impressed by the projects I see submitted, and this one is truly stellar. &nbsp;He has brought a ton of talent, time and dedication to make this happen. &nbsp;I am excited to see it posted here. &nbsp;</em></p>
<p><em>This&nbsp;battery charger can charge 6-12 Volt Lead Acid batteries and has an LCD for display relevant charge data.</em></p>
<p><em>Roland was also very kind to walk through the design process, provide the code he used and supply some great pictures – please enjoy!</em></p>
<p><span id="more-5697"></span></p>
<h2>Requirements for the Charger and Basic Design</h2>
<p>My solar panel system has a 24V battery-bank, consisting of 4x 6V 225Ah Trojan open Lead Acid deep-cycle batteries.</p>
<p>In the summertime, they get charged via a Victron MultiPlus inverter / charge-controller. In the winter, to keep the batteries “topped-up”, I needed a “powerful” sophisticated charger which can do one battery individually, or two batteries in series.</p>
<p>The charger needed to be able to perform all the three charge-stages required for a Lead-Acid battery; Absorption-charge, Equalization-charge and Float-charge (Check at the bottom of this post for some highly recommended reading about Lead-Acid-Battery charging)</p>
<p>The donor for my project was an old 6-12V “dump-charger”.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/enclosure.jpg" rel="attachment wp-att-5698"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/enclosure.jpg" alt="Enclosure used for Arduino Controlled Battery Charger" width="720" height="405" class="aligncenter wp-image-5699" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure.jpg 1920w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure-300x169.jpg 300w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure-768x432.jpg 768w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure-1024x576.jpg 1024w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure-720x405.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/enclosure-432x243.jpg 432w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Since I’m far from a qualified electrical engineer, I had to search for schematics. The basis for the electronic-schematic was found on <a href="http://www.bristolwatch.com/solar1.htm" target="_blank">Lewis Loflins website</a>.</p>
<p>A big “Thank You” to Lewis! <em><strong>Please visit his website to learn in-depth how the circuitry works.</strong></em> Lewis does an outstanding job explaining the nitty-gritty details.</p>
<p>Different from the Lewis design (he used solar panels as a power-source) is that a conversion to a grid-power-source was needed.</p>
<p>An Arduino Mini Pro ATMega 328 was chosen for the project, small and cheap to build in. The circuitry and sketch currently presented is developed after several builds and learnings derived from mistakes / practical problems.</p>
<h2>Challenges, Experimenting, and Learning Along the Way</h2>
<p>One of my first prototype attempts failed because I wasn’t paying attention to the internal resistance (Rds On) of the Mosfet used.</p>
<p>The power-Mosfet I had laying around had a Rds On of 4 Ohm. With a current of 7 – 8 Ampere, the waste heat:</p>
<p>P= I2*R = 8*8*4 = 256 Watt!</p>
<p>The Mosfet in the circuitry, the IRF4905, has a Rds On of 0.02Ω. &nbsp;The waste heat is now P = 8*8*0.02 = 1.28 Watt – a substantial difference!</p>
<p>A major problem in building my charger turned out to be the power-supply, and everything depending on it, i.e the Arduino.</p>
<p>I chose to power the Arduino from the main DC power-rail (see schematic 2 of 4), which was (with no load) either around 11VDC, or 22VDC, depending which charge voltage was chosen.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Schematic_2-page_OP.jpg" rel="attachment wp-att-5700"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Schematic_2-page_OP.jpg" alt="Schematic 2 of 4 for the Arduino Controlled Battery Charger" width="720" height="1018" class="aligncenter size-full wp-image-5700" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/Schematic_2-page_OP.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/Schematic_2-page_OP-212x300.jpg 212w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>The maximum voltage which can be applied to the L7805 (TO-220 package), 5V linear voltage regulator is 35Volt.</p>
<p>A 6V battery has, depending of the Depth-of-Discharge (DOD) an open circuit voltage of about 5.75V when fully discharged and 6.37V when fully charged.</p>
<p>Connecting a 6-Volt battery to the transformer causes the voltage in the main DC power-rail to drop to whatever the voltage of the battery is.</p>
<p>Of course, if you have a transformer as big as your home, it may be different, but we are talking normal-size, like 150 – 200VA transformers.</p>
<p>Besides the voltage-drop caused by the battery, the power-source is AC, meaning that 100x (@50Hz) or 120x (@60Hz) per second, it goes to zero.</p>
<p>The <em>dropout voltage</em>, the voltage needed by the L7805 to deliver a constant 5V output, is about 6.5Volt.</p>
<p>Anything below the drop-out voltage, and the 5Volt output drops / fluctuates accordingly.</p>
<p>Using big electrolyte capacitors can partially dampen the AC factor, but not much can be done to the main DC power-rail voltage drop caused by the battery.</p>
<p>The Arduino Mini Pro seemed to work fine with voltages below 5V, but since any analogRead depends on a stable input Voltage, or reference Voltage, all analog Voltage- and current-readings obtained via voltage dividers and a ACS712 Hall-current-sensor were all-over-the-place and, therefore, unusable.</p>
<p>Initially, I tried using a TL431A, 2.495V precision zener voltage reference, which has, with a 1 kΩ resistor in series, a drop out voltage of around 2.8V. This worked great for the analog charge- and battery-readings.</p>
<p>Unlike the ACS712 Hall-current-sensor, which needs a constant operating Voltage of 5V, the ACS711 can operate with voltages as low as 3.3V. The ACS712 chip was changed out for an ACS711.</p>
<p>After a few try &amp; errors and for practical reasons, I ended up using a L78L33 (3.3V TO-92 package) voltage regulator as a power-supply for the ACS711 and, instead of the TL431A zener, as a 3.3V voltage reference.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC5-1.jpg" rel="attachment wp-att-5706"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC5-1.jpg" alt="perf board circuit of Arduino Controlled Battery Charger" width="720" height="519" class="aligncenter wp-image-5706 size-full" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC5-1.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC5-1-300x216.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>The dropout voltage of the L78L33 is about 3.8V and can handle a maximum voltage supply of 30V.</p>
<p>Combined with electrolytic capacitors, the analog readings are now stable when charging 6 Volt batteries. Obviously, none of these problems do occur when charging batteries higher than 6.5V (the L7805 dropout voltage).</p>
<p>As Lewis Loflin explains in his videos, when using higher voltages on the DC power-rail, protection has to be built in to prevent exceeding the Mosfet Vgs (maximum voltage across the Gate and Source). For the IRF4905, this is 20V.</p>
<p>In the 12 Volt charger mode, this is done by using a zener-diode in series with the gate. However, to obtain the Gate threshold Voltage (-4V) in the 6Volt charge-mode, this zener-diode has to be removed, shorted or by-passed.</p>
<p>Initially, two NPN transistors were used. One transistor to connect to ground and another one to bypass the zener-diode. This worked fine until a DC rail Voltage of about 20V. At higher voltages, the IRF4905 mosfet turned on. (Perhaps this was due to current leakage through the transistor collector-base?)</p>
<p>The zener bypass transistor was replaced by a small TO-92 package BS170 mosfet. This solved the problem and the circuitry works now 100%. In hindsight, replacing both transistors with the BS170 mosfets may work even better and no gate-resistors are required.</p>
<h2>Another Lesson Learned was the LCD-Display</h2>
<p>The first display used was a reclaimed 16×2, or 1602 display without backlight. This turned out to be not very smart, as battery-chargers often get used in garages or sheds and most are not very well illuminated.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC14.jpg" rel="attachment wp-att-5701"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC14.jpg" alt="LCD display for Arduino Controlled Battery Charger" width="720" height="517" class="aligncenter size-full wp-image-5701" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC14.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC14-300x215.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Also, LCD-displays use up a lot of I/O pins. This time, the LCD has backlight and is I2C controlled. A I2C-backpack with a PCF8574AT was connected to the 16×2 LCD. I2C uses, next to VCC and GND, only 2 data lines, SCL and SMA, normally connected to analog pins A4 &amp; A5 of the Arduino.</p>
<p>If the Arduino Mini Pro is chosen, and if you want to use I2C, attention has to be paid that the board has (the provision for) the analog pins A4 and A5.</p>
<p>As you can see on this picture, this Arduino Mini Pro has two additional holes, just below the analog pins A2 and A3. These two holes are A4 and A5. Not all Mini Pro’s have this feature, so be aware.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Mini-Pro-with-A4_A5.jpg" rel="attachment wp-att-5702"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Mini-Pro-with-A4_A5.jpg" alt="Arduino pro mini used with Arduino Controlled Battery Charger" width="720" height="475" class="aligncenter size-full wp-image-5702" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/Mini-Pro-with-A4_A5.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/Mini-Pro-with-A4_A5-300x198.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Also, be aware that the Arduino Mini Pro doesn’t have an Aref pin (at least, I haven’t seen one), for connecting to the external reference voltage.</p>
<p>Pin 20 of the ATMEGA 328 chip is the Aref pin. On my board, pin 20 is connected to a SMD capacitor. This capacitor, obviously on the pin 20 side, offers a nice “big” opportunity to solder a small wire to. I fed that wire, for strain relief, through a few unused pinholes on the top-end of the board.</p>
<p>When switching a coil (the transformer) On/Off, inductive voltage spikes do occur.</p>
<p>In one of my earlier attempts, with different resistor values for the voltage dividers and no protection in place, I fried the analog I/O pins of my Arduino board <img draggable="false" class="emoji" alt="🙁" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1f641.svg"></p>
<p>With the current divider resistor values and a 30V zener diode included, the I/O pins should be safe.</p>
<p>To reduce the transformer inrush current, a NTC Thermistor (5D-15) was added.</p>
<p><strong>For additional safety, the transformer is equipped with a fuse and a normally closed (NC) thermo-switch, 85 degC (185F).</strong></p>
<p><strong>The transformer can get hot, especially while charging 12 Volt batteries. Make sure you choose a transformer which is up for the job; 150VA or higher.</strong></p>
<p>When the transformer is powered by 120V, a bigger fuse is required. I added a little cooling fan, using an LM35 temperature sensor, and it’s steered with Arduino PWM to keep things cool in 12Volt charging mode.</p>
<p>The fan is optional, and as such indicated, in the IDE Sketch. If not required, “comment” the indicated sections.</p>
<h2>Building the Circuit on a Perforation Board</h2>
<p>The Arduino Mini Pro was mounted on a 5 x 7 cm perforation-board.</p>
<p>I used SIL female headers on the perf-board for mounting the Arduino. This enabled me to remove the Arduino while working on the board.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC3.jpg" rel="attachment wp-att-5703"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC3.jpg" width="720" height="582" class="aligncenter wp-image-5707 size-full" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC3.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC3-300x243.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>As it turned out, using the SIL headers, a nice space below the Arduino was created for a large 4700µF 6.3V capacitor to smooth out / store energy in the 5V supply.</p>
<p>Since the 5V is supplied by the L7805, which can deliver 1.5A, ample additional 5V- and GND-pins were added to the board.</p>
<p>The main DC power-rail, soldered on the bottom of the board, consisted of solid 1.5mm2 (≈ 16AWG) copper-wire.</p>
<p>To avoid contact with the metal-enclosure, the perf-board was mounted on 4 standoffs. The KBPC5010 rectify-bridge and the IRF4905 Mosfet were for cooling purposes. Both were mounted against the metal-enclosure. Cooling-paste was used for optimum heat transfer.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC13.jpg" rel="attachment wp-att-5704"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC13.jpg" alt="Open Enclosure view of this Arduino Controlled Battery Charger" width="720" height="589" class="aligncenter size-full wp-image-5704" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC13.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC13-300x245.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>To reset the Arduino, a momentary pushbutton was added in the back of the enclosure. The Reset-button will, when pressed, connect the RST-pin to GND.</p>
<p>The enclosure front was custom made out of a 2mm plastic sheet and spray-painted.</p>
<p>The metal enclosure itself was sanded and spray-painted.</p>
<h2>Writing the Arduino Code</h2>
<p>This is my first “major” self-written Arduino sketch. &nbsp;(You can download the sketch below).</p>
<p>Most of the programming language was learned at Programming Electronics Academy, so a big “Thank You” to Michael for all his energy and efforts that he has put in his very well laid out website and very well explained lessons.</p>
<p>I’m sure, looking back in a few years time, that the sketch could have been written much more sophisticated and efficient, but…it’s what it is and it works fine <img draggable="false" class="emoji" alt="😉" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1f609.svg"></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5d06ac425d25e448208373" class="crayon-syntax crayon-theme-arduino-pea crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 14px; margin-bottom: 14px; font-size: 16px !important; line-height: 20px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 16px !important; height: 24px !important; line-height: 24px !important; margin-top: -24px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 16px !important;height: 24px !important; line-height: 24px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Arduino</span></div></div>
			<div class="crayon-info" style="min-height: 22.4px !important; line-height: 22.4px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 16px !important; line-height: 20px !important; z-index: 0; opacity: 0; overflow: hidden;">/* This programme is written for charging Trojan T-225Ah 6/12Volt open Lead Acid batteries (LAB),
 *  but it can easily be adapted for another LAB's and/or charge values.
 *  Before I give an explanation, intended as a guide, about charging LAB's; an important note:
 *  ***** Do NOT leave a LAB in a discharged condition or discharge it too low ******
 *  This will drastically shorten its life, if not completely destroy it! Always charge
 *  a LAB after usage, a.s.a.p.! There are different types of LAB's, each with its own characteristics.
 *  There are open LAB's and closed LAB's, also called VRLA (valve-regulated-lead-acid), such as gell-
 *  and AGM-batteries. Batteries are build for different purposes; deep-cycle, car, marine, etc, etc. Each
 *  have their own characteristics and charge patterns. If you want to know more about LAB's, a highly
 *  recommended read would be: http://www.victronenergy.dk/upload/documents/Book-Energy-Unlimited-EN.pdf
 *  Each LAB knows 3x charge-stages; Float-, Absorption- and an Equalisation-charge. Normally an
 *  absorption-charge is sufficient to recharge the battery and to keep it in a good shape. After
 *  the absorption-charge, a float-charge can be applied to keep the battery constantly "topped-up".
 *  An Equalisation-charge is only required either; every few months or when the specific-gravity of
 *  the acid in a individual cell differs more than 0.02 sg compared to the other cells, from
 *  the same battery. Via a switch, the charger can be set for 6V or 12V. Another mode-switch selects 
 *  absorption-charge (Trojan 6V T-225: 7.40V, 12V: 14.8V) or equalization charge (Trojan: 7.75V / 15.5V).
 *  In either case, this sketch will keep the voltage at the absorption voltage / float level,
 *  or at the equalization voltage level; whichever charge-mode has been selected.
 *  In the absorption-mode, when the current reaches 2% of the battery capacity,
 *  the battery is considered to be full; in this case 2% of 225Ah = 4.5Amps @ 7.40V.
 *  When in absorption charge, this sketch switches to float-charge as soon as the "battery full
 *  current" is reached. Be aware that this isn't the case in equalization mode!!
 *  The duration of an Equalisation-charge should be no longer until the acid specific gravity of all cells
 *  have an equal, or nearly equal readings. An Equalisation charge is very hard on the battery
 *  and should only be performed when necessary, as short as possible and manually / observed.
 *  In no way the charger &amp; battery should be left unattended during an equalisation charge.
 *  Each type of LAB has its own manufacture recommended charge-voltages. Check yours first!!
 *  Since charging of a LAB is a chemical process, it needs time to occur. The charge-current
 *  for a LAB is therefor max. 10% of the battery capacity. For a 225Ah LAB, this is no more
 *  than 22.5 Amps (lower is fine too). Of course, the charge-source self, the Mosfet and the cables,
 *  all have to be suitably rated for these high currents.
 *  During charging, a close eye needs to be kept on the temperatures of all components involved;
 *  the Mosfet, the battery, the cables, panels / transformer etc.
 *  The same schematic pricipals were used as from lewis Loflin (http://www.bristolwatch.com/solar1.htm).
 *  If you like an excellent thorough explanation of how the schematic works, please visit his website.
 *  An Arduino (in this case a Arduino mini pro) steers, via a NPN transistor, a "P-channel" Mosfet.
 *  The In/Out voltage is read via a resistor voltage divider and the current is measured via
 *  a 25Amp ASC711 Hall Sensor.
 *  Combined with LED-indicators, a 16x2 LCD is added for read-out, checks &amp; messages.
 *  The Arduino is powered via a 5V L7805, 1.5 Amp voltage regulator. The regulator is connected to
 *  the incoming voltage on the charge-side.
 *  When, instead of Solar-panels, a transformer is used, a circuitry protection against induction
 *  Voltage-spikes has to be included.
 *  When the charger is connected the the battery and switched on, best is to press the reset-button. 
 *  This will ensure that the Arduino has the latest correct Voltage readings. Failure to do so, 
 *  may cause that the Arduino has incorrect readings in its memory, taken while starting up / connecting up.
 *  For in the 12Volt charging mode, a cooling fan with an LM35 temperature sensor can be included. 
 *  To include, all the code in between the "optional cooling fan" dotted lines have to be Uncommented. 
 *  This example code is in the public domain.
 *
  modified 24 November 2015
  by RvD.
*/


#include&lt;Wire.h&gt;// include I2C wiring LCD display
#include&lt;LiquidCrystal_I2C.h&gt;       // include display I2C, connect SDA to A4, SCL to A5 
LiquidCrystal_I2C LCD(0x3F, 16, 2); // tells Adruino the LCD I2C address and display size. The chip ACF8574-AT
                                    // has I2C address 0x3F, the chip ACF8574-T has I2C address 0x27
# define chargeReading A0           // Analog pin for reading charger voltage
# define batteryReading A1          // analog pin for reading battery voltage
# define ampReading A2              // analog pin for reading output-voltage from the current-sensor
# define transistorPin 13           // output pin via a 2.2kΩ resistor to NPN-transistor basis for Mosfet control.
# define modeSwitchPin 2            // selector Switch for absorption or equalization charge
# define zenerByPassPin 11          // to write transistor High to Bypass zener in 6V mode
# define absorptionLed 3            // pin to steer absorption indicator Led
# define equalizationLed 4          // pin to steer equalization indicator Led
# define twelveVLed 5               // pin to steer twelve-volt indicator Led
# define sixVLed 6                  // pin to steer six-volt indicator Led
//--------------------------Begin of optional cooling fan-------------------
# define tempCPin A3                // Pin for LM35 temperature sensor input
# define temperatureLed 8           // warning Led in case the temperature exceeds max-temperature
# define fanPWMTransistor 9         // pin, via 2.2kΩ resistor, to base of fan PWM switching transistor
//--------------------------End of optional cooling fan-------------------
int batteryVoltage = 0;             // initialize and define batteryVoltage
int chargeVoltage = 0;              // initialize and define chargeVoltage
int ampVoltage = 0;                 // initialize and define voltage from ACS711 current-sensor
int floatVoltage6V = 260;           // float voltage 6.60V =&gt; ADC reading over 1k/6.8k divider
int absorptionVoltage6V = 292;      // absorption voltage 7.40V =&gt; ADC reading over a 1k/6.8k divider
int equalizeVoltage6V = 306;        // equalization voltage 7.75V =&gt; ADC reading over a 1k/6.8k divider
int lowCutOffVoltage6V = 217 ;      // Below 5.5V something is wrong with the clamps or worse, the battery
float conversionFactor6V = 0.02534; // Conversion factor in the 6V range to get from the analog value to Voltage
int sixOrTwelvePoint = 475;         // six-or-twelve volt charge cross-over point set at around 11.5V
int floatVoltage12V = 522;          // float voltage 13.2V =&gt; ADC reading over 1k/6.8k divider
int absorptionVoltage12V = 586;     // absorption voltage 14.8V =&gt; ADC reading over a 1k/6.8k divider
int equalizeVoltage12V = 614;       // equalization voltage 15.5V =&gt; ADC reading over a 1k/6.8k divider
int lowCutOffVoltage12V = 455;      // Battery Voltage below 11.5 V, something is wrong with the clamps or the battery
float conversionFactor12V = 0.02525;// Conversion factor in the 12V range to get from the analog value to Voltage
float battFullCurrent = 4.0;        // Current (in Amps) at which the batt is considered full during absoption and
                                    // switches over to float charge.
float battFullCurrentAnalog;        // number used after conversion from battFullCurrent to analog number.
int currentZero = 514;              // ADC number given by the ACS711 current-sensor with no current flowing
int gridFrequency = 50;             // Grid Frequency, change if required.
float periodTime;                   // time in milltseconds of 1 full grid-cycle; 50Hz = 20ms, 60Hz = 16.66ms
float averageAmpVoltage = 0;        // Since the Current is AC, averages are taken
float averageChargeReading;         // Since the charge Voltage is AC, averages are taken
float currentADCRatio = 16.735;     // current-sensor ADC reading calibrated for 1 ampere.
float ampere;                       // declare a variable
int switchPosition;                 // declare a variable for absorption or equalize position
//-------------------------Begin of optional cooling fan--------------------
int tempC;                          // temperature read from the temperature sensor
int fanSpeed;                       // the PWM duty cycle for the fan speed
int tempMin = 70;                   // minimum temerature in degC at which the fan has to start cooling at minimum speed
int tempMax = 85;                   // the maximum temperature in degC at which the fan has to run full speed
long previousMillis = 0;
long interval = 1000;               // setting the blaink rate in milli-seconds
//--------------------------End of optional cooling fan--------------------


void setup() {

  Serial.begin(9600);                // Setup the serial monitor, very handy for trouble shooting
  analogReference(EXTERNAL);         // Instead of using the default 5V supply, a TL431 with 2.5 voltage reference is used
  pinMode(chargeReading, INPUT);     // setup pinMode for input from voltage divider charger side
  pinMode(batteryReading, INPUT);    // setup pinMode for input from voltage divider battery side
  pinMode(ampReading, INPUT);        // setup pinMode for input from current-sensor
  pinMode(zenerByPassPin, OUTPUT);   // setup pinMode for output to bypass transistor zener.
  digitalWrite(zenerByPassPin, LOW); // set the base of the zener bypass transistor LOW = OFF.
  pinMode(transistorPin, OUTPUT);    // Mosfet steering is done via the transistor base. Putting the transistor base
                                     // HIGH, pulls the Mosfet Gate to ground = LOW =&gt; Mosfet "ON"
  digitalWrite(transistorPin, LOW);  // set the base of the switching Transistor LOW =&gt; OFF
  pinMode (modeSwitchPin, INPUT);    // Switch (STDP) for selecting absorption or equalize-charge
  digitalWrite(modeSwitchPin, LOW);  // write mode-switch low for absorptiob charge
  pinMode(sixVLed, OUTPUT);          // set six-volt LedPin mode as output
  digitalWrite(sixVLed, LOW);        // set low = 6V indicator led off
  pinMode(twelveVLed, OUTPUT);       // set twelve-volt LedPin as output
  digitalWrite(twelveVLed, LOW);     // set low = q2V indicator led off
  pinMode(absorptionLed, OUTPUT);    // set absorption indicator ledpin as output
  digitalWrite(absorptionLed, LOW);  // set pin Low
  pinMode(equalizationLed, OUTPUT);  // set equalization indicator ledpin as output
  digitalWrite(equalizationLed, LOW);// set pin Low
//---------------------------Begin of optional cooling fan-----------------
  pinMode (tempCPin, INPUT);         // set pin to receive LM35 temperature sensor output
  pinMode (fanPWMTransistor, OUTPUT);// set the pin to steer the base of the fan steering transistor
  digitalWrite(fanPWMTransistor,LOW);// set pin low = transistor off
  pinMode (temperatureLed, OUTPUT);  // set the pin for the high temperature warning led
  digitalWrite(temperatureLed,LOW);  // set pin low = temperature Led off
//---------------------------End of optional cooling fan-------------------
  LCD.init();                        // initialise LCD
  LCD.backlight();                   // Turn-on backlight, which is oof in default
  LCD.setCursor(0, 0);               // set the cursor at the top-left-hand corner
  periodTime = 1000 / gridFrequency; // in milliseconds
  battFullCurrentAnalog = (battFullCurrent * currentADCRatio); // converting user amp input to ADC reading

}

void loop() {
  
  // Determine whether the charger is set for 6V or 12V charge
  // Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out
  int j = 1; // set, or reset, counter
  averageChargeReading = 0; //reset averageAmpVoltage
  while (j &lt;= 2 * periodTime) {
    averageChargeReading += analogRead(chargeReading);
    j++;
    delay(1);
  }
  chargeVoltage = (averageChargeReading / (2 * periodTime)); // calculating the average charge Voltage

  if (chargeVoltage &lt;= sixOrTwelvePoint) { // if lower than sixOrTwelvePoint, do the 6V charge, else 12V charge
    
// ------------------------- Initialization of 6 Volt charge-----------------------------
    
    digitalWrite(sixVLed, HIGH);     // Led indicating the program is in 6V charge mode
    digitalWrite(twelveVLed, LOW);   // as a precaution and to remove previous settings
    switchPosition = digitalRead(modeSwitchPin); // check the mode switch selection; absorption or equalize

    if (switchPosition == HIGH &amp;&amp; chargeVoltage &lt;= sixOrTwelvePoint) { // mode switch HIGH means 6V equalisation has been selected

//---------------------------Begin of 6V Equalisation loop------------------------------
      
      digitalWrite(equalizationLed, HIGH);      // set equalization indicator Led
      digitalWrite(absorptionLed, LOW);         // set absorption indicator Led
      
      batteryVoltage = analogRead(batteryReading); // Read battery Voltage

      // Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out
      int j = 1; // set, or reset, counter
      averageChargeReading = 0; //reset averageAmpVoltage
      while (j &lt;= 2 * periodTime) {
        averageChargeReading += analogRead(chargeReading);
        j++;
        delay(1);
      }

      chargeVoltage = (averageChargeReading / (2 * periodTime)); // calculating the average charge Voltage

      Serial.println(chargeVoltage);

      if ((chargeVoltage &lt; equalizeVoltage6V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage6V)) { // check charge voltage
        LCD.home();
        LCD.print("Charge Volt Low ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &lt;= equalizeVoltage6V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage6V)) { // check both Voltages
        LCD.home();
        LCD.print("IN &amp; OUT too Low");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &gt; equalizeVoltage6V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage6V)) {
        /* check battery voltage.
              If below the set threshold "lowCutOffVoltage", the charger will not start to charge.
           *  Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.
           *  In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.
           *  Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */

        LCD.home();
        LCD.print("Batt Volt LOW!");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      }

      if ((chargeVoltage &gt; batteryVoltage) &amp;&amp; (chargeVoltage &lt;= sixOrTwelvePoint) &amp;&amp; (batteryVoltage &lt;= equalizeVoltage6V) &amp;&amp; (chargeVoltage &gt; equalizeVoltage6V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage6V)) {
        // if all these 5 conditions are true, start charging.
        // if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected,
        // no voltage is supplied to them and therefor no risk of shorting them.

        LCD.home();
        LCD.print("Equal ");
        LCD.print("Batt=");
        LCD.print(batteryVoltage * conversionFactor6V);
        LCD.print ("V");

        int chargeON = (equalizeVoltage6V - batteryVoltage) * 100; // determine the Mosfet ON time
        chargeON = abs(chargeON);   // make it alway a positive number

        digitalWrite(zenerByPassPin, HIGH); // set zener bypass Mosfet high, to exclude Mosfet Vgs protection zener
        digitalWrite (transistorPin, HIGH); // transistor turns Mosfet gate LOW = ON
        delay (0.5 * chargeON); // to get the charge current started and stabelize

        // Because the chargeCurrent is an AC current, more readings are taken and then averaged out
        int j = 1; // set, or reset, counter
        averageAmpVoltage = 0; //reset averageAmpVoltage
        while (j &lt;= 2 * periodTime) {
          averageAmpVoltage += analogRead(ampReading);
          j++;
          delay(1);
        }
        
        averageAmpVoltage = averageAmpVoltage / (2 * periodTime);
        ampVoltage = currentZero - averageAmpVoltage;
        ampVoltage = abs(ampVoltage); // make ampVoltage always a positive voltage
        ampere = ampVoltage / currentADCRatio; // convert ampVoltage to amperes
        LCD.setCursor(0, 1); // reset cursor
        LCD.print("Current:"); // print to LCD
        LCD.print(ampere); // print to LCD
        LCD.print(" Amp"); // print to LCD

        delay(0.5 * chargeON);
        digitalWrite(transistorPin, LOW); // transistor turns off, Mosfet gate goes HIGH =&gt; OFF
        digitalWrite(zenerByPassPin, LOW); // set zener bypass Mosfet LOW, to include Mosfet Vgs protection zener

      } // end of if statement
      
      switchPosition = digitalRead(modeSwitchPin); //check swithMode for changes
      chargeVoltage = analogRead(chargeReading);   // check the chargeVoltage again for 6-12V chargeMode
      delay(10);                                   // to allow anolagReading to settle
      
    } // end of if statement

//----------------------------End of 6V Equalize loop-----------------------------


//--------------------------- Begin of 6V Absorption loop-------------------------

    else {

      digitalWrite(equalizationLed, LOW);      // set equalization indicator Led
      digitalWrite(absorptionLed, HIGH);       // set absorption indicator Led
      
      // Because the Charge-Transformer is AC, more Voltage readings are required and then averaged out
        int j = 1; // set, or reset, counter
        averageChargeReading = 0; //reset average Voltage on the AC charge side
        while (j &lt;= 2 * periodTime) { // take readings for 2 periods
        averageChargeReading += analogRead(chargeReading); // compound readings
        j++; // add to counter
        delay(1);
      } // delay 1ms

      chargeVoltage = (averageChargeReading / (2 * periodTime));
      batteryVoltage = analogRead(batteryReading);
      ampVoltage = abs(currentZero - analogRead(ampReading));

      if ((chargeVoltage &lt; absorptionVoltage6V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage6V)) { // check the charge voltage
        LCD.home();
        LCD.print("Charge Volt LOW ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &lt;= absorptionVoltage6V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage6V)) {// check charge and batt
        LCD.home();
        LCD.print("IN &amp; OUT too LOW");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if-statement

      if ((chargeVoltage &gt; absorptionVoltage6V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage6V)) {
        /* check battery voltage,
              if below the set threshold "lowCutOffVoltage", the charger will not charge.
           *  Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.
           *  In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.
           *  Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */

        LCD.home();
        LCD.print("Batt Volt LOW!   ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      }

      if ((chargeVoltage &gt; batteryVoltage) &amp;&amp; (chargeVoltage &lt;= sixOrTwelvePoint) &amp;&amp; (batteryVoltage &lt;= absorptionVoltage6V) &amp;&amp; (chargeVoltage &gt; absorptionVoltage6V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage6V)) {
        // if all these 5 conditions are true, start charging.
        // if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected, no voltage is supplied
        // to them and therefor no risk of shorting.

          LCD.home();
          if (absorptionVoltage12V == floatVoltage12V) {
            LCD.print("Float ");
          }
          
          else { 
            LCD.print("AbsP  ");
          }
          
          LCD.print("Batt=");
          LCD.print(batteryVoltage * conversionFactor6V);
          LCD.print ("V");
          

        int chargeON = (absorptionVoltage6V - batteryVoltage) * 100; // determine the Mosfet ON time
        chargeON = abs(chargeON); // make it alway a positive number

        digitalWrite(zenerByPassPin, HIGH); // set zener bypass Mosfet high, to exclude Mosfet Vgs protection zener
        digitalWrite (transistorPin, HIGH); // transistor turns Mosfet gate LOW = ON
        delay (0.5 * chargeON); // time to give charge current to start and stabelize

        // Because the chargeCurrent is an AC current, more readings are taken and then averaged out

        int j = 1; // set, or reset, counter
        averageAmpVoltage = 0; //reset averageAmpVoltage
        while (j &lt;= 2 * periodTime) {
          averageAmpVoltage += analogRead(ampReading);
          j++;
          delay(1);
        }
        
        averageAmpVoltage = averageAmpVoltage / (2 * periodTime);
        ampVoltage = currentZero - averageAmpVoltage;
        ampVoltage = abs(ampVoltage); // make ampVoltage always a positive voltage
        ampere = ampVoltage / currentADCRatio; // convert ampVoltage to amperes
        LCD.setCursor(0, 1); // reset cursor
        LCD.print("Current:"); // print to LCD
        LCD.print(ampere); // print to LCD
        LCD.print(" Amp"); // print to LCD
        Serial.println(ampere);

        delay(0.5 * chargeON);
        digitalWrite(transistorPin, LOW); // transistor turns off, Mosfet gate goes HIGH =&gt; OFF
        digitalWrite(zenerByPassPin, LOW); // set zener bypass Mosfet LOW, to include Mosfet Vgs protection zener

      } // end of if-statement

      if (ampVoltage &lt;= battFullCurrentAnalog &amp;&amp; batteryVoltage &gt;= absorptionVoltage6V &amp;&amp; chargeVoltage &gt;= floatVoltage6V) {
        // if raw ampreading &lt;= battery full current and battery Voltage &gt;= floatVoltage

        absorptionVoltage6V = floatVoltage6V; // change absorption Voltage to float Voltage.
        batteryVoltage = analogRead (batteryReading);
        LCD.clear();
        LCD.home();
        LCD.print("Float charge");
        LCD.setCursor(0, 1);
        LCD.print("Batt: ");
        LCD.print(batteryVoltage * conversionFactor6V);
        LCD.print("V");
        delay(200);
      }
      
      switchPosition = digitalRead(modeSwitchPin); //check swithMode for changes
      chargeVoltage = analogRead(chargeReading);   // check the chargeVoltage again for 6-12V chargeMode
      delay(10);                                   // to allow anolagReading to settle 
      
    } // end of else statement
//---------------------------------End of 6V Absoption loop-------------------------------
  } // end of 6V charging mode


  else { // -----------------------Initialization of 12V charging ----------------------------

    digitalWrite(zenerByPassPin, LOW); // set zener bypass Mosfet low, to include Mosfet Vgs protection zener
    digitalWrite(sixVLed, LOW);     // as a precaution and to remove previous settings.
    digitalWrite(twelveVLed, HIGH); // Led indicating the program is in 6V charge mode

//---------------------------------Begin optional cooling fan ----------------------------

      tempC = (analogRead(tempCPin)* 0.48828125);// read temperature sensor and convert to Celcius
       
       if(tempC &lt; tempMin) {                     // if temp is lower than minimum temp
           fanSpeed = 0;                         // set value of variable.
           digitalWrite(fanPWMTransistor, LOW);  // write base of fan transistor LOW =&gt; Fan = OFF.  
       } 
       if(tempC &gt;= tempMin) {                                 // if temperature is higher than minimum temp, start cooling
           fanSpeed = map(tempC, tempMin, tempMax, 60, 255); // convert temperature reading to PWM output range, a starting
                                                             // duty cycle of 60 to overcome initial fan starting friction
           fanSpeed = constrain (fanSpeed, 60, 255);         // constrain fanSpeed within PWM range
           analogWrite(fanPWMTransistor, fanSpeed);          // PWM to the fan.
       } 
       
       if(tempC &gt; tempMax) {                            // if temp is higher than tempMaxa, start the temperature waring Led
        unsigned long currentMillis = millis();         // Read current milliseconds clock
        if(currentMillis - previousMillis &gt; interval){  // compare
          previousMillis = currentMillis;
          if(temperatureLed == LOW){                    // if temperature Led is Low, set High.
            digitalWrite(temperatureLed, HIGH);
          }
          else {                                        // if temperature Led is High, set Low.
            digitalWrite(temperatureLed, LOW);
          }
        }
       }
//---------------------------------End of optional cooling fan --------------------------

    switchPosition = digitalRead(modeSwitchPin); // check the mode switch selection; absorption or equalize

    if (switchPosition == HIGH &amp;&amp; chargeVoltage &gt; sixOrTwelvePoint) { // mode switch HIGH means 12V equalisation has been selected

//---------------------------------Begin of 12V Equalisation loop---------------------
      
      digitalWrite(equalizationLed, HIGH);      // set equalization indicator Led
      digitalWrite(absorptionLed, LOW);         // set absorption indicator Led
      
      batteryVoltage = analogRead(batteryReading); // Read battery Voltage

      // Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out
      int j = 1; // set, or reset, counter
      averageChargeReading = 0; //reset averageAmpVoltage
      while (j &lt;= 2 * periodTime) {
        averageChargeReading += analogRead(chargeReading);
        j++;
        delay(1);
      }

      chargeVoltage = (averageChargeReading / (2 * periodTime)); // calculating the average charge Voltage

      if ((chargeVoltage &lt; equalizeVoltage12V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage12V)) { // check charge voltage
        LCD.home();
        LCD.print("Charge Volt Low ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &lt;= equalizeVoltage12V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage12V)) { // check both Voltages
        LCD.home();
        LCD.print("IN &amp; OUT too Low");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &gt; equalizeVoltage12V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage12V)) {
        /* check battery voltage.
              If below the set threshold "lowCutOffVoltage", the charger will not start to charge.
           *  Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.
           *  In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.
           *  Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */

        LCD.home();
        LCD.print("Batt Volt LOW!  ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      }

      if ((chargeVoltage &gt; batteryVoltage) &amp;&amp; (batteryVoltage &lt;= equalizeVoltage12V) &amp;&amp; (chargeVoltage &gt; equalizeVoltage12V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage12V)) {
        // if all these 4 conditions are true, start charging.
        // if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected,
        // no voltage is supplied to them and therefor no risk of shorting them.

        LCD.home();
        LCD.print("Equal ");
        LCD.print("Batt=");
        LCD.print(batteryVoltage * conversionFactor12V);
        LCD.print ("V");

        int chargeON = (equalizeVoltage12V - batteryVoltage) * 100; // determine the Mosfet ON time
        chargeON = abs(chargeON);   // make it alway a positive number

        digitalWrite (transistorPin, HIGH); // transistor turns Mosfet gate LOW = ON
        delay (0.5 * chargeON); // to get the charge current started and stabelize

        // Because the chargeCurrent is an AC current, more readings are taken and then averaged out
        int j = 1; // set, or reset, counter
        averageAmpVoltage = 0; //reset averageAmpVoltage
        while (j &lt;= 2 * periodTime) {
          averageAmpVoltage += analogRead(ampReading);
          j++;
          delay(1);
        }
        
        averageAmpVoltage = averageAmpVoltage / (2 * periodTime);
        ampVoltage = currentZero - averageAmpVoltage;
        ampVoltage = abs(ampVoltage); // make ampVoltage always a positive voltage
        ampere = ampVoltage / currentADCRatio; // convert ampVoltage to amperes
        LCD.setCursor(0, 1); // reset cursor
        LCD.print("Current:"); // print to LCD
        LCD.print(ampere); // print to LCD
        LCD.print(" Amp"); // print to LCD

        delay(0.5 * chargeON);
        digitalWrite(transistorPin, LOW); // transistor turns off, Mosfet gate goes HIGH =&gt; OFF
      } // end of if statement
      
      switchPosition = digitalRead(modeSwitchPin); //check swithMode for changes
      chargeVoltage = analogRead(chargeReading);   // check the chargeVoltage again for 6-12V chargeMode
      delay(10); // to allow anolagReading to settle
    } // end of if statement

//-----------------------------End of 12V Equalize loop-----------------------


//-----------------------------Begin of 12V Absorption loop----------------------

    else {

      digitalWrite(equalizationLed, LOW);      // set equalization indicator Led
      digitalWrite(absorptionLed, HIGH);       // set absorption indicator Led

      // Because the Charge-Transformer is AC, more Voltage readings are required and then averaged out
      int j = 1; // set, or reset, counter
      averageChargeReading = 0; //reset average Voltage on the AC charge side
      while (j &lt;= 2 * periodTime) { // take readings for 2 periods
        averageChargeReading += analogRead(chargeReading); // compound readings
        j++; // add to counter
        delay(1);
      } // delay 1ms

      chargeVoltage = (averageChargeReading / (2 * periodTime));
      batteryVoltage = analogRead(batteryReading);
      ampVoltage = abs(currentZero - analogRead(ampReading));

      if ((chargeVoltage &lt; absorptionVoltage12V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage12V)) { // check the charge voltage
        LCD.home();
        LCD.print("Charge Volt LOW ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      } // end of if statement

      if ((chargeVoltage &lt;= absorptionVoltage12V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage12V)) {// check charge and batt
        LCD.home();
        LCD.print("IN &amp; OUT too LOW");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      }

      if ((chargeVoltage &gt; absorptionVoltage12V) &amp;&amp; (batteryVoltage &lt;= lowCutOffVoltage12V)) {
        /* check battery voltage,
              if below the set threshold "lowCutOffVoltage", the charger will not charge.
           *  Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.
           *  In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.
           *  Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */

        LCD.home();
        LCD.print("Batt Volt LOW!  ");
        LCD.setCursor(0, 1);
        LCD.print("                ");
      }

      if ((chargeVoltage &gt; batteryVoltage) &amp;&amp; (batteryVoltage &lt;= absorptionVoltage12V) &amp;&amp; (chargeVoltage &gt; absorptionVoltage12V) &amp;&amp; (batteryVoltage &gt; lowCutOffVoltage12V)) {
        // if all these 4 conditions are true, start charging.
        // if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected, no voltage is supplied
        // to them and therefor no risk of shorting them.

          LCD.home();
          if (absorptionVoltage12V == floatVoltage12V) {
            LCD.print("Float ");
          }
          else { LCD.print("AbsP  ");}
          LCD.print("Batt=");
          LCD.print(batteryVoltage * conversionFactor12V);
          LCD.print ("V");
        
        int chargeON = (absorptionVoltage12V - batteryVoltage) * 100; // determine the Mosfet ON time
        chargeON = abs(chargeON); // make it alway a positive number

        digitalWrite (transistorPin, HIGH); // transistor turns Mosfet gate LOW = ON
        delay (0.5 * chargeON); // time to give charge current to start and stabelize

        // Because the chargeCurrent is an AC current, more readings are taken and then averaged out

        int j = 1; // set, or reset, counter
        averageAmpVoltage = 0; //reset averageAmpVoltage
        while (j &lt;= 2 * periodTime) {
          averageAmpVoltage += analogRead(ampReading);
          j++;
          delay(1);
        }
        averageAmpVoltage = averageAmpVoltage / (2 * periodTime);
        ampVoltage =abs (currentZero - averageAmpVoltage);
        ampere = ampVoltage / currentADCRatio; // convert ampVoltage to amperes
        LCD.setCursor(0, 1); // reset cursor
        LCD.print("Current:"); // print to LCD
        LCD.print(ampere); // print to LCD
        LCD.print(" Amp"); // print to LCD

        delay(0.5 * chargeON);
        digitalWrite(transistorPin, LOW); // transistor turns off, Mosfet gate goes HIGH =&gt; OFF

      } // end of if-statement


      if (ampVoltage &lt;= battFullCurrentAnalog &amp;&amp; batteryVoltage &gt;= absorptionVoltage12V &amp;&amp; chargeVoltage &gt;= floatVoltage12V) {
        // if raw ampreading &lt;= battery full current and battery Voltage &gt;= floatVoltage

        absorptionVoltage12V = floatVoltage12V; // change absorption Voltage to float Voltage.
        
        LCD.home();
        LCD.print("Float charge    ");
        LCD.setCursor(0, 1);
        LCD.print("Batt: ");
        LCD.print(batteryVoltage * conversionFactor12V);
        LCD.print("V    ");
        delay(20);

      }
      switchPosition = digitalRead(modeSwitchPin); // check swithMode for changes
      chargeVoltage = analogRead(chargeReading);   // check the chargeVoltage again for 6-12V chargeMode
      delay(10);                                   // to allow anolagReading to settle
    } // end of else statement
//-----------------------------------End of 12V Absoption loop------------------------
  } // end of else statement.

}// end of void-loop</textarea></div>
			<div class="crayon-main" style="max-height: 500px; position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 16px !important; line-height: 20px !important;"><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-2">2</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-4">4</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-6">6</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-8">8</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-10">10</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-12">12</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-14">14</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-16">16</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-18">18</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-20">20</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-22">22</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-24">24</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-26">26</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-28">28</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-30">30</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-32">32</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-34">34</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-36">36</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-38">38</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-40">40</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-42">42</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-44">44</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-46">46</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-48">48</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-50">50</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-52">52</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-54">54</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-56">56</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-58">58</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-60">60</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-62">62</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-64">64</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-66">66</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-68">68</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-70">70</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-72">72</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-74">74</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-76">76</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-78">78</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-80">80</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-82">82</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-84">84</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-86">86</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-88">88</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-90">90</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-92">92</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-94">94</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-96">96</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-98">98</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-100">100</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-102">102</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-104">104</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-106">106</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-108">108</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-110">110</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-112">112</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-114">114</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-115">115</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-116">116</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-118">118</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-120">120</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-122">122</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-124">124</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-126">126</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-128">128</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-130">130</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-132">132</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-133">133</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-134">134</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-135">135</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-136">136</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-137">137</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-138">138</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-139">139</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-140">140</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-141">141</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-142">142</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-143">143</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-144">144</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-145">145</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-146">146</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-147">147</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-148">148</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-149">149</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-150">150</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-151">151</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-152">152</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-153">153</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-154">154</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-155">155</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-156">156</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-157">157</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-158">158</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-159">159</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-160">160</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-161">161</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-162">162</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-163">163</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-164">164</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-165">165</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-166">166</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-167">167</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-168">168</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-169">169</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-170">170</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-171">171</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-172">172</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-173">173</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-174">174</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-175">175</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-176">176</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-177">177</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-178">178</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-179">179</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-180">180</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-181">181</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-182">182</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-183">183</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-184">184</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-185">185</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-186">186</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-187">187</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-188">188</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-189">189</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-190">190</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-191">191</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-192">192</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-193">193</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-194">194</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-195">195</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-196">196</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-197">197</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-198">198</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-199">199</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-200">200</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-201">201</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-202">202</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-203">203</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-204">204</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-205">205</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-206">206</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-207">207</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-208">208</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-209">209</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-210">210</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-211">211</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-212">212</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-213">213</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-214">214</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-215">215</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-216">216</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-217">217</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-218">218</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-219">219</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-220">220</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-221">221</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-222">222</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-223">223</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-224">224</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-225">225</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-226">226</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-227">227</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-228">228</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-229">229</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-230">230</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-231">231</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-232">232</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-233">233</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-234">234</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-235">235</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-236">236</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-237">237</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-238">238</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-239">239</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-240">240</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-241">241</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-242">242</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-243">243</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-244">244</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-245">245</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-246">246</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-247">247</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-248">248</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-249">249</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-250">250</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-251">251</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-252">252</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-253">253</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-254">254</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-255">255</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-256">256</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-257">257</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-258">258</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-259">259</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-260">260</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-261">261</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-262">262</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-263">263</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-264">264</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-265">265</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-266">266</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-267">267</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-268">268</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-269">269</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-270">270</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-271">271</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-272">272</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-273">273</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-274">274</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-275">275</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-276">276</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-277">277</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-278">278</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-279">279</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-280">280</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-281">281</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-282">282</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-283">283</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-284">284</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-285">285</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-286">286</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-287">287</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-288">288</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-289">289</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-290">290</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-291">291</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-292">292</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-293">293</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-294">294</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-295">295</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-296">296</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-297">297</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-298">298</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-299">299</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-300">300</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-301">301</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-302">302</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-303">303</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-304">304</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-305">305</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-306">306</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-307">307</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-308">308</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-309">309</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-310">310</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-311">311</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-312">312</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-313">313</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-314">314</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-315">315</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-316">316</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-317">317</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-318">318</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-319">319</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-320">320</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-321">321</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-322">322</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-323">323</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-324">324</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-325">325</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-326">326</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-327">327</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-328">328</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-329">329</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-330">330</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-331">331</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-332">332</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-333">333</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-334">334</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-335">335</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-336">336</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-337">337</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-338">338</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-339">339</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-340">340</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-341">341</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-342">342</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-343">343</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-344">344</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-345">345</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-346">346</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-347">347</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-348">348</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-349">349</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-350">350</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-351">351</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-352">352</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-353">353</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-354">354</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-355">355</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-356">356</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-357">357</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-358">358</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-359">359</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-360">360</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-361">361</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-362">362</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-363">363</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-364">364</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-365">365</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-366">366</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-367">367</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-368">368</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-369">369</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-370">370</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-371">371</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-372">372</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-373">373</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-374">374</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-375">375</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-376">376</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-377">377</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-378">378</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-379">379</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-380">380</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-381">381</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-382">382</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-383">383</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-384">384</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-385">385</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-386">386</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-387">387</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-388">388</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-389">389</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-390">390</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-391">391</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-392">392</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-393">393</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-394">394</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-395">395</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-396">396</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-397">397</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-398">398</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-399">399</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-400">400</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-401">401</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-402">402</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-403">403</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-404">404</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-405">405</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-406">406</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-407">407</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-408">408</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-409">409</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-410">410</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-411">411</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-412">412</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-413">413</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-414">414</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-415">415</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-416">416</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-417">417</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-418">418</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-419">419</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-420">420</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-421">421</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-422">422</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-423">423</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-424">424</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-425">425</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-426">426</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-427">427</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-428">428</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-429">429</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-430">430</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-431">431</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-432">432</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-433">433</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-434">434</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-435">435</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-436">436</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-437">437</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-438">438</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-439">439</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-440">440</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-441">441</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-442">442</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-443">443</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-444">444</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-445">445</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-446">446</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-447">447</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-448">448</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-449">449</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-450">450</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-451">451</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-452">452</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-453">453</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-454">454</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-455">455</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-456">456</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-457">457</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-458">458</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-459">459</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-460">460</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-461">461</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-462">462</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-463">463</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-464">464</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-465">465</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-466">466</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-467">467</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-468">468</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-469">469</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-470">470</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-471">471</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-472">472</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-473">473</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-474">474</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-475">475</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-476">476</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-477">477</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-478">478</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-479">479</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-480">480</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-481">481</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-482">482</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-483">483</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-484">484</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-485">485</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-486">486</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-487">487</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-488">488</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-489">489</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-490">490</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-491">491</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-492">492</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-493">493</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-494">494</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-495">495</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-496">496</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-497">497</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-498">498</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-499">499</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-500">500</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-501">501</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-502">502</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-503">503</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-504">504</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-505">505</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-506">506</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-507">507</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-508">508</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-509">509</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-510">510</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-511">511</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-512">512</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-513">513</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-514">514</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-515">515</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-516">516</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-517">517</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-518">518</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-519">519</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-520">520</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-521">521</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-522">522</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-523">523</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-524">524</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-525">525</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-526">526</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-527">527</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-528">528</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-529">529</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-530">530</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-531">531</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-532">532</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-533">533</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-534">534</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-535">535</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-536">536</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-537">537</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-538">538</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-539">539</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-540">540</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-541">541</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-542">542</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-543">543</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-544">544</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-545">545</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-546">546</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-547">547</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-548">548</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-549">549</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-550">550</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-551">551</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-552">552</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-553">553</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-554">554</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-555">555</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-556">556</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-557">557</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-558">558</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-559">559</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-560">560</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-561">561</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-562">562</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-563">563</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-564">564</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-565">565</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-566">566</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-567">567</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-568">568</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-569">569</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-570">570</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-571">571</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-572">572</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-573">573</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-574">574</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-575">575</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-576">576</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-577">577</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-578">578</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-579">579</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-580">580</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-581">581</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-582">582</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-583">583</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-584">584</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-585">585</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-586">586</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-587">587</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-588">588</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-589">589</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-590">590</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-591">591</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-592">592</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-593">593</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-594">594</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-595">595</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-596">596</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-597">597</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-598">598</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-599">599</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-600">600</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-601">601</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-602">602</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-603">603</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-604">604</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-605">605</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-606">606</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-607">607</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-608">608</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-609">609</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-610">610</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-611">611</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-612">612</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-613">613</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-614">614</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-615">615</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-616">616</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-617">617</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-618">618</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-619">619</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-620">620</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-621">621</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-622">622</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-623">623</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-624">624</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-625">625</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-626">626</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-627">627</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-628">628</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-629">629</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-630">630</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-631">631</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-632">632</div><div class="crayon-num" data-line="crayon-5d06ac425d25e448208373-633">633</div><div class="crayon-num crayon-striped-num" data-line="crayon-5d06ac425d25e448208373-634">634</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 20px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5d06ac425d25e448208373-1"><span class="crayon-c">/* This programme is written for charging Trojan T-225Ah 6/12Volt open Lead Acid batteries (LAB),</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-2"><span class="crayon-c"> *&nbsp;&nbsp;but it can easily be adapted for another LAB's and/or charge values.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-3"><span class="crayon-c"> *&nbsp;&nbsp;Before I give an explanation, intended as a guide, about charging LAB's; an important note:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-4"><span class="crayon-c"> *&nbsp;&nbsp;***** Do NOT leave a LAB in a discharged condition or discharge it too low ******</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-5"><span class="crayon-c"> *&nbsp;&nbsp;This will drastically shorten its life, if not completely destroy it! Always charge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-6"><span class="crayon-c"> *&nbsp;&nbsp;a LAB after usage, a.s.a.p.! There are different types of LAB's, each with its own characteristics.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-7"><span class="crayon-c"> *&nbsp;&nbsp;There are open LAB's and closed LAB's, also called VRLA (valve-regulated-lead-acid), such as gell-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-8"><span class="crayon-c"> *&nbsp;&nbsp;and AGM-batteries. Batteries are build for different purposes; deep-cycle, car, marine, etc, etc. Each</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-9"><span class="crayon-c"> *&nbsp;&nbsp;have their own characteristics and charge patterns. If you want to know more about LAB's, a highly</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-10"><span class="crayon-c"> *&nbsp;&nbsp;recommended read would be: http://www.victronenergy.dk/upload/documents/Book-Energy-Unlimited-EN.pdf</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-11"><span class="crayon-c"> *&nbsp;&nbsp;Each LAB knows 3x charge-stages; Float-, Absorption- and an Equalisation-charge. Normally an</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-12"><span class="crayon-c"> *&nbsp;&nbsp;absorption-charge is sufficient to recharge the battery and to keep it in a good shape. After</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-13"><span class="crayon-c"> *&nbsp;&nbsp;the absorption-charge, a float-charge can be applied to keep the battery constantly "topped-up".</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-14"><span class="crayon-c"> *&nbsp;&nbsp;An Equalisation-charge is only required either; every few months or when the specific-gravity of</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-15"><span class="crayon-c"> *&nbsp;&nbsp;the acid in a individual cell differs more than 0.02 sg compared to the other cells, from</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-16"><span class="crayon-c"> *&nbsp;&nbsp;the same battery. Via a switch, the charger can be set for 6V or 12V. Another mode-switch selects </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-17"><span class="crayon-c"> *&nbsp;&nbsp;absorption-charge (Trojan 6V T-225: 7.40V, 12V: 14.8V) or equalization charge (Trojan: 7.75V / 15.5V).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-18"><span class="crayon-c"> *&nbsp;&nbsp;In either case, this sketch will keep the voltage at the absorption voltage / float level,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-19"><span class="crayon-c"> *&nbsp;&nbsp;or at the equalization voltage level; whichever charge-mode has been selected.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-20"><span class="crayon-c"> *&nbsp;&nbsp;In the absorption-mode, when the current reaches 2% of the battery capacity,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-21"><span class="crayon-c"> *&nbsp;&nbsp;the battery is considered to be full; in this case 2% of 225Ah = 4.5Amps @ 7.40V.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-22"><span class="crayon-c"> *&nbsp;&nbsp;When in absorption charge, this sketch switches to float-charge as soon as the "battery full</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-23"><span class="crayon-c"> *&nbsp;&nbsp;current" is reached. Be aware that this isn't the case in equalization mode!!</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-24"><span class="crayon-c"> *&nbsp;&nbsp;The duration of an Equalisation-charge should be no longer until the acid specific gravity of all cells</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-25"><span class="crayon-c"> *&nbsp;&nbsp;have an equal, or nearly equal readings. An Equalisation charge is very hard on the battery</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-26"><span class="crayon-c"> *&nbsp;&nbsp;and should only be performed when necessary, as short as possible and manually / observed.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-27"><span class="crayon-c"> *&nbsp;&nbsp;In no way the charger &amp; battery should be left unattended during an equalisation charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-28"><span class="crayon-c"> *&nbsp;&nbsp;Each type of LAB has its own manufacture recommended charge-voltages. Check yours first!!</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-29"><span class="crayon-c"> *&nbsp;&nbsp;Since charging of a LAB is a chemical process, it needs time to occur. The charge-current</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-30"><span class="crayon-c"> *&nbsp;&nbsp;for a LAB is therefor max. 10% of the battery capacity. For a 225Ah LAB, this is no more</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-31"><span class="crayon-c"> *&nbsp;&nbsp;than 22.5 Amps (lower is fine too). Of course, the charge-source self, the Mosfet and the cables,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-32"><span class="crayon-c"> *&nbsp;&nbsp;all have to be suitably rated for these high currents.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-33"><span class="crayon-c"> *&nbsp;&nbsp;During charging, a close eye needs to be kept on the temperatures of all components involved;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-34"><span class="crayon-c"> *&nbsp;&nbsp;the Mosfet, the battery, the cables, panels / transformer etc.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-35"><span class="crayon-c"> *&nbsp;&nbsp;The same schematic pricipals were used as from lewis Loflin (http://www.bristolwatch.com/solar1.htm).</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-36"><span class="crayon-c"> *&nbsp;&nbsp;If you like an excellent thorough explanation of how the schematic works, please visit his website.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-37"><span class="crayon-c"> *&nbsp;&nbsp;An Arduino (in this case a Arduino mini pro) steers, via a NPN transistor, a "P-channel" Mosfet.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-38"><span class="crayon-c"> *&nbsp;&nbsp;The In/Out voltage is read via a resistor voltage divider and the current is measured via</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-39"><span class="crayon-c"> *&nbsp;&nbsp;a 25Amp ASC711 Hall Sensor.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-40"><span class="crayon-c"> *&nbsp;&nbsp;Combined with LED-indicators, a 16x2 LCD is added for read-out, checks &amp; messages.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-41"><span class="crayon-c"> *&nbsp;&nbsp;The Arduino is powered via a 5V L7805, 1.5 Amp voltage regulator. The regulator is connected to</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-42"><span class="crayon-c"> *&nbsp;&nbsp;the incoming voltage on the charge-side.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-43"><span class="crayon-c"> *&nbsp;&nbsp;When, instead of Solar-panels, a transformer is used, a circuitry protection against induction</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-44"><span class="crayon-c"> *&nbsp;&nbsp;Voltage-spikes has to be included.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-45"><span class="crayon-c"> *&nbsp;&nbsp;When the charger is connected the the battery and switched on, best is to press the reset-button. </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-46"><span class="crayon-c"> *&nbsp;&nbsp;This will ensure that the Arduino has the latest correct Voltage readings. Failure to do so, </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-47"><span class="crayon-c"> *&nbsp;&nbsp;may cause that the Arduino has incorrect readings in its memory, taken while starting up / connecting up.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-48"><span class="crayon-c"> *&nbsp;&nbsp;For in the 12Volt charging mode, a cooling fan with an LM35 temperature sensor can be included. </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-49"><span class="crayon-c"> *&nbsp;&nbsp;To include, all the code in between the "optional cooling fan" dotted lines have to be Uncommented. </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-50"><span class="crayon-c"> *&nbsp;&nbsp;This example code is in the public domain.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-51"><span class="crayon-c"> *</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-52"><span class="crayon-c">&nbsp;&nbsp;modified 24 November 2015</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-53"><span class="crayon-c">&nbsp;&nbsp;by RvD.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-54"><span class="crayon-c">*/</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-56">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-57"><span class="crayon-p">#include&lt;Wire.h&gt;// include I2C wiring LCD display</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-58"><span class="crayon-p">#include&lt;LiquidCrystal_I2C.h&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // include display I2C, connect SDA to A4, SCL to A5 </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-59"><span class="crayon-v">LiquidCrystal</span><span class="crayon-sy">_</span>I2C<span class="crayon-h"> </span><span class="crayon-v">LCD</span><span class="crayon-sy">(</span><span class="crayon-cn">0x3F</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// tells Adruino the LCD I2C address and display size. The chip ACF8574-AT</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// has I2C address 0x3F, the chip ACF8574-T has I2C address 0x27</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-61"><span class="crayon-p"># define chargeReading A0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // Analog pin for reading charger voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-62"><span class="crayon-p"># define batteryReading A1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// analog pin for reading battery voltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-63"><span class="crayon-p"># define ampReading A2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// analog pin for reading output-voltage from the current-sensor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-64"><span class="crayon-p"># define transistorPin 13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // output pin via a 2.2kΩ resistor to NPN-transistor basis for Mosfet control.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-65"><span class="crayon-p"># define modeSwitchPin 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// selector Switch for absorption or equalization charge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-66"><span class="crayon-p"># define zenerByPassPin 11&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// to write transistor High to Bypass zener in 6V mode</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-67"><span class="crayon-p"># define absorptionLed 3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pin to steer absorption indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-68"><span class="crayon-p"># define equalizationLed 4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pin to steer equalization indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-69"><span class="crayon-p"># define twelveVLed 5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // pin to steer twelve-volt indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-70"><span class="crayon-p"># define sixVLed 6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// pin to steer six-volt indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-71"><span class="crayon-c">//--------------------------Begin of optional cooling fan-------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-72"><span class="crayon-p"># define tempCPin A3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// Pin for LM35 temperature sensor input</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-73"><span class="crayon-p"># define temperatureLed 8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // warning Led in case the temperature exceeds max-temperature</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-74"><span class="crayon-p"># define fanPWMTransistor 9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; // pin, via 2.2kΩ resistor, to base of fan PWM switching transistor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-75"><span class="crayon-c">//--------------------------End of optional cooling fan-------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-76"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// initialize and define batteryVoltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-77"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// initialize and define chargeVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-78"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// initialize and define voltage from ACS711 current-sensor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-79"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">260</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// float voltage 6.60V =&gt; ADC reading over 1k/6.8k divider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-80"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">292</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// absorption voltage 7.40V =&gt; ADC reading over a 1k/6.8k divider</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-81"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">306</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// equalization voltage 7.75V =&gt; ADC reading over a 1k/6.8k divider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-82"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">217</span><span class="crayon-h"> </span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Below 5.5V something is wrong with the clamps or worse, the battery</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-83"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.02534</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Conversion factor in the 6V range to get from the analog value to Voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-84"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">475</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// six-or-twelve volt charge cross-over point set at around 11.5V</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-85"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">522</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// float voltage 13.2V =&gt; ADC reading over 1k/6.8k divider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-86"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">586</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// absorption voltage 14.8V =&gt; ADC reading over a 1k/6.8k divider</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-87"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">614</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// equalization voltage 15.5V =&gt; ADC reading over a 1k/6.8k divider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-88"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">455</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Battery Voltage below 11.5 V, something is wrong with the clamps or the battery</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-89"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.02525</span><span class="crayon-sy">;</span><span class="crayon-c">// Conversion factor in the 12V range to get from the analog value to Voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-90"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">battFullCurrent</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4.0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Current (in Amps) at which the batt is considered full during absoption and</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-91"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// switches over to float charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-92"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">battFullCurrentAnalog</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// number used after conversion from battFullCurrent to analog number.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-93"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">514</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// ADC number given by the ACS711 current-sensor with no current flowing</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-94"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">gridFrequency</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Grid Frequency, change if required.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-95"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// time in milltseconds of 1 full grid-cycle; 50Hz = 20ms, 60Hz = 16.66ms</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-96"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Since the Current is AC, averages are taken</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-97"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">averageChargeReading</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Since the charge Voltage is AC, averages are taken</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-98"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16.735</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// current-sensor ADC reading calibrated for 1 ampere.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-99"><span class="crayon-r">float</span><span class="crayon-h"> </span><span class="crayon-v">ampere</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// declare a variable</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-100"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">switchPosition</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// declare a variable for absorption or equalize position</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-101"><span class="crayon-c">//-------------------------Begin of optional cooling fan--------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-102"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">tempC</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// temperature read from the temperature sensor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-103"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">fanSpeed</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// the PWM duty cycle for the fan speed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-104"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">tempMin</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">70</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// minimum temerature in degC at which the fan has to start cooling at minimum speed</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-105"><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">tempMax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">85</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// the maximum temperature in degC at which the fan has to run full speed</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-106"><span class="crayon-r">long</span><span class="crayon-h"> </span><span class="crayon-v">previousMillis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-107"><span class="crayon-r">long</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// setting the blaink rate in milli-seconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-108"><span class="crayon-c">//--------------------------End of optional cooling fan--------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-109">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-110">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-111"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">setup</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-112">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-113"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">Serial</span><span class="crayon-sy">.</span><span class="crayon-v">begin</span><span class="crayon-sy">(</span><span class="crayon-cn">9600</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Setup the serial monitor, very handy for trouble shooting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-114"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">analogReference</span><span class="crayon-sy">(</span><span class="crayon-v">EXTERNAL</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Instead of using the default 5V supply, a TL431 with 2.5 voltage reference is used</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-115"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">INPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// setup pinMode for input from voltage divider charger side</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-116"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">INPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// setup pinMode for input from voltage divider battery side</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-117"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">INPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// setup pinMode for input from current-sensor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-118"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// setup pinMode for output to bypass transistor zener.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-119"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set the base of the zener bypass transistor LOW = OFF.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-120"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Mosfet steering is done via the transistor base. Putting the transistor base</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// HIGH, pulls the Mosfet Gate to ground = LOW =&gt; Mosfet "ON"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-122"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// set the base of the switching Transistor LOW =&gt; OFF</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-123"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">INPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Switch (STDP) for selecting absorption or equalize-charge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-124"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// write mode-switch low for absorptiob charge</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-125"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">sixVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set six-volt LedPin mode as output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-126"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">sixVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set low = 6V indicator led off</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-127"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">twelveVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set twelve-volt LedPin as output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-128"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">twelveVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set low = q2V indicator led off</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-129"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set absorption indicator ledpin as output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-130"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// set pin Low</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-131"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// set equalization indicator ledpin as output</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-132"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-c">// set pin Low</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-133"><span class="crayon-c">//---------------------------Begin of optional cooling fan-----------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-134"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">tempCPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">INPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set pin to receive LM35 temperature sensor output</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-135"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">fanPWMTransistor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-c">// set the pin to steer the base of the fan steering transistor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-136"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">fanPWMTransistor</span><span class="crayon-sy">,</span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-c">// set pin low = transistor off</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-137"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">pinMode</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">temperatureLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">OUTPUT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// set the pin for the high temperature warning led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-138"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">temperatureLed</span><span class="crayon-sy">,</span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// set pin low = temperature Led off</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-139"><span class="crayon-c">//---------------------------End of optional cooling fan-------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-140"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">init</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// initialise LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-141"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">backlight</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Turn-on backlight, which is oof in default</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-142"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set the cursor at the top-left-hand corner</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-143"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">periodTime</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">gridFrequency</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// in milliseconds</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-144"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">battFullCurrentAnalog</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">battFullCurrent</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// converting user amp input to ADC reading</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-145">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-146"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-147">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-148"><span class="crayon-t">void</span><span class="crayon-h"> </span><span class="crayon-st">loop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-149"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-150"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Determine whether the charger is set for 6V or 12V charge</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-151"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-152"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-153"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-154"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-156"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-157"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-158"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-159"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// calculating the average charge Voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-160">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-161"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// if lower than sixOrTwelvePoint, do the 6V charge, else 12V charge</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-162"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-163"><span class="crayon-c">// ------------------------- Initialization of 6 Volt charge-----------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-164"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-165"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">sixVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Led indicating the program is in 6V charge mode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-166"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">twelveVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// as a precaution and to remove previous settings</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// check the mode switch selection; absorption or equalize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-168">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-169"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// mode switch HIGH means 6V equalisation has been selected</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-170">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-171"><span class="crayon-c">//---------------------------Begin of 6V Equalisation loop------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-172"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-173"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set equalization indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-174"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set absorption indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-175"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-176"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Read battery Voltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-177">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-178"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-179"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-180"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-181"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-182"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-183"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-184"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-185"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-186">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-187"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// calculating the average charge Voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-188">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-189"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-190">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-191"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check charge voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-192"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-193"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Charge Volt Low "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-194"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-195"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-196"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-197">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-198"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check both Voltages</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-199"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-200"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"IN &amp; OUT too Low"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-201"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-202"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-203"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-204">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-205"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-206"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* check battery voltage.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-207"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If below the set threshold "lowCutOffVoltage", the charger will not start to charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-208"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-209"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-210"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-211">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-212"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-213"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt Volt LOW!"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-214"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-215"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-216"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-217">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-218"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-219"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if all these 5 conditions are true, start charging.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-220"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-221"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// no voltage is supplied to them and therefor no risk of shorting them.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-222">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-223"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-224"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Equal "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-225"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt="</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-226"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor6V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-227"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"V"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-228">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-229"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">equalizeVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// determine the Mosfet ON time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-230"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// make it alway a positive number</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-231">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-232"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set zener bypass Mosfet high, to exclude Mosfet Vgs protection zener</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-233"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns Mosfet gate LOW = ON</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-234"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// to get the charge current started and stabelize</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-235">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-236"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the chargeCurrent is an AC current, more readings are taken and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-237"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-238"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-239"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-240"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-241"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-242"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-243"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-244"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-245"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-246"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-247"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">ampVoltage</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// make ampVoltage always a positive voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-248"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampere</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// convert ampVoltage to amperes</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-249"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// reset cursor</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-250"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Current:"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-251"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">ampere</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-252"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">" Amp"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-253">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-254"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-255"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns off, Mosfet gate goes HIGH =&gt; OFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-256"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set zener bypass Mosfet LOW, to include Mosfet Vgs protection zener</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-257">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-258"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-259"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-260"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//check swithMode for changes</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-261"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// check the chargeVoltage again for 6-12V chargeMode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-262"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// to allow anolagReading to settle</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-263"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-264"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-265">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-266"><span class="crayon-c">//----------------------------End of 6V Equalize loop-----------------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-267">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-268">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-269"><span class="crayon-c">//--------------------------- Begin of 6V Absorption loop-------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-270">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-271"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-272">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-273"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set equalization indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-274"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set absorption indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-275"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-276"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the Charge-Transformer is AC, more Voltage readings are required and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-277"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-278"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset average Voltage on the AC charge side</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-279"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// take readings for 2 periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-280"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// compound readings</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-281"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// add to counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-282"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-283"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// delay 1ms</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-284">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-285"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-286"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-287"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-288">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-289"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check the charge voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-290"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-291"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Charge Volt LOW "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-292"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-293"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-294"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-295">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-296"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-c">// check charge and batt</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-297"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-298"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"IN &amp; OUT too LOW"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-299"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-300"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-301"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if-statement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-302">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-303"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-304"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* check battery voltage,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-305"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if below the set threshold "lowCutOffVoltage", the charger will not charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-306"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-307"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-308"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-309">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-310"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-311"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt Volt LOW!&nbsp;&nbsp; "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-312"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-313"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-314"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-315">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-316"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-317"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if all these 5 conditions are true, start charging.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-318"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected, no voltage is supplied</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-319"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// to them and therefor no risk of shorting.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-320">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-321"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-322"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-323"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Float "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-324"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-325"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-326"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-327"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"AbsP&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-328"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-329"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-330"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt="</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-331"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor6V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-332"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"V"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-333"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-334">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-335"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// determine the Mosfet ON time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-336"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// make it alway a positive number</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-337">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-338"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set zener bypass Mosfet high, to exclude Mosfet Vgs protection zener</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-339"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns Mosfet gate LOW = ON</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-340"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// time to give charge current to start and stabelize</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-341">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-342"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the chargeCurrent is an AC current, more readings are taken and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-343">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-344"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-345"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-346"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-347"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-348"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-349"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-350"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-351"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-352"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-353"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-354"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">ampVoltage</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// make ampVoltage always a positive voltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-355"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampere</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// convert ampVoltage to amperes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-356"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// reset cursor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-357"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Current:"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-358"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">ampere</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-359"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">" Amp"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-360"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">Serial</span><span class="crayon-sy">.</span><span class="crayon-e">println</span><span class="crayon-sy">(</span><span class="crayon-v">ampere</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-361">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-362"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-363"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns off, Mosfet gate goes HIGH =&gt; OFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-364"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set zener bypass Mosfet LOW, to include Mosfet Vgs protection zener</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-365">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-366"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if-statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-367">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-368"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">battFullCurrentAnalog</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage6V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-369"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if raw ampreading &lt;= battery full current and battery Voltage &gt;= floatVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-370">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-371"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">absorptionVoltage6V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage6V</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// change absorption Voltage to float Voltage.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-372"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-373"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">clear</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-374"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-375"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Float charge"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-376"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-377"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-378"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor6V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-379"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"V"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-380"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-381"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-382"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-383"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//check swithMode for changes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-384"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// check the chargeVoltage again for 6-12V chargeMode</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-385"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// to allow anolagReading to settle </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-386"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-387"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of else statement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-388"><span class="crayon-c">//---------------------------------End of 6V Absoption loop-------------------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-389"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of 6V charging mode</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-390">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-391">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-392"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// -----------------------Initialization of 12V charging ----------------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-393">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-394"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">zenerByPassPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set zener bypass Mosfet low, to include Mosfet Vgs protection zener</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-395"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">sixVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// as a precaution and to remove previous settings.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-396"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">twelveVLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Led indicating the program is in 6V charge mode</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-397">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-398"><span class="crayon-c">//---------------------------------Begin optional cooling fan ----------------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-399">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-400"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tempC</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">tempCPin</span><span class="crayon-sy">)</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.48828125</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-c">// read temperature sensor and convert to Celcius</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-401"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-402"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">tempC</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">tempMin</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// if temp is lower than minimum temp</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-403"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">fanSpeed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set value of variable.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-404"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">fanPWMTransistor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// write base of fan transistor LOW =&gt; Fan = OFF.&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-405"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-406"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">tempC</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">tempMin</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// if temperature is higher than minimum temp, start cooling</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-407"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">fanSpeed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">map</span><span class="crayon-sy">(</span><span class="crayon-v">tempC</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tempMin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tempMax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// convert temperature reading to PWM output range, a starting</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-408"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// duty cycle of 60 to overcome initial fan starting friction</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-409"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">fanSpeed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">constrain</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">fanSpeed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// constrain fanSpeed within PWM range</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-410"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">analogWrite</span><span class="crayon-sy">(</span><span class="crayon-v">fanPWMTransistor</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fanSpeed</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// PWM to the fan.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-411"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-412"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-413"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">tempC</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">tempMax</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if temp is higher than tempMaxa, start the temperature waring Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-414"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">unsigned</span><span class="crayon-h"> </span><span class="crayon-r">long</span><span class="crayon-h"> </span><span class="crayon-v">currentMillis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">millis</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Read current milliseconds clock</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-415"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">currentMillis</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">previousMillis</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">interval</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">// compare</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-416"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">previousMillis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">currentMillis</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-417"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">temperatureLed</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if temperature Led is Low, set High.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-418"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">temperatureLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-419"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-420"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if temperature Led is High, set Low.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-421"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">temperatureLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-422"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-423"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-424"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-425"><span class="crayon-c">//---------------------------------End of optional cooling fan --------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-426">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-427"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// check the mode switch selection; absorption or equalize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-428">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-429"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">sixOrTwelvePoint</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// mode switch HIGH means 12V equalisation has been selected</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-430">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-431"><span class="crayon-c">//---------------------------------Begin of 12V Equalisation loop---------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-432"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-433"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set equalization indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-434"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set absorption indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-435"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-436"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// Read battery Voltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-437">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-438"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the Charge-Transformer is AC, more Voltage readings are taken and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-439"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-440"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-441"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-442"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-443"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-444"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-445"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-446">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-447"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// calculating the average charge Voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-448">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-449"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check charge voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-450"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-451"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Charge Volt Low "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-452"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-453"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-454"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-455">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-456"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check both Voltages</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-457"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-458"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"IN &amp; OUT too Low"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-459"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-460"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-461"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-462">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-463"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-464"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* check battery voltage.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-465"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If below the set threshold "lowCutOffVoltage", the charger will not start to charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-466"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-467"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-468"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-469">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-470"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-471"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt Volt LOW!&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-472"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-473"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-474"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-475">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-476"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-477"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if all these 4 conditions are true, start charging.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-478"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-479"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// no voltage is supplied to them and therefor no risk of shorting them.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-480">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-481"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-482"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Equal "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-483"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt="</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-484"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor12V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-485"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"V"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-486">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-487"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">equalizeVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// determine the Mosfet ON time</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-488"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// make it alway a positive number</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-489">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-490"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns Mosfet gate LOW = ON</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-491"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// to get the charge current started and stabelize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-492">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-493"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the chargeCurrent is an AC current, more readings are taken and then averaged out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-494"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-495"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-496"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-497"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-498"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-499"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-500"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-501"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-502"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-503"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-504"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">ampVoltage</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// make ampVoltage always a positive voltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-505"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampere</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// convert ampVoltage to amperes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-506"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// reset cursor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-507"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Current:"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-508"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">ampere</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-509"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">" Amp"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-510">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-511"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-512"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns off, Mosfet gate goes HIGH =&gt; OFF</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-513"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-514"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-515"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//check swithMode for changes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-516"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// check the chargeVoltage again for 6-12V chargeMode</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-517"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// to allow anolagReading to settle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-518"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-519">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-520"><span class="crayon-c">//-----------------------------End of 12V Equalize loop-----------------------</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-521">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-522">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-523"><span class="crayon-c">//-----------------------------Begin of 12V Absorption loop----------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-524">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-525"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-526">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-527"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">equalizationLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// set equalization indicator Led</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-528"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">absorptionLed</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// set absorption indicator Led</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-529">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-530"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the Charge-Transformer is AC, more Voltage readings are required and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-531"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-532"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset average Voltage on the AC charge side</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-533"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// take readings for 2 periods</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-534"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// compound readings</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-535"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// add to counter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-536"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-537"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// delay 1ms</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-538">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-539"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">averageChargeReading</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-540"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">batteryReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-541"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-542">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-543"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-c">// check the charge voltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-544"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-545"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Charge Volt LOW "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-546"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-547"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-548"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-549">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-550"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-c">// check charge and batt</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-551"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-552"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"IN &amp; OUT too LOW"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-553"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-554"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-555"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-556">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-557"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-558"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">/* check battery voltage,</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-559"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if below the set threshold "lowCutOffVoltage", the charger will not charge.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-560"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Either the clamps are not good connected or the battery has been drained so far, that it most likely has been damaged.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-561"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;In that case, the threshold voltage can be set lower, but now the battery has to be supervised during the charge process.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-562"><span class="crayon-c">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;Even if the battery (partially) recovers, damage has been done and has shorten its lifetime / capacity */</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-563">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-564"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-565"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt Volt LOW!&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-566"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-567"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-568"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-569">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-570"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">lowCutOffVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-571"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if all these 4 conditions are true, start charging.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-572"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if one of the conditions is not true, no charging will occur. This also means that when the battery clamps are not connected, no voltage is supplied</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-573"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// to them and therefor no risk of shorting them.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-574">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-575"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-576"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-577"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Float "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-578"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-579"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"AbsP&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-580"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt="</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-581"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor12V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-582"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">"V"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-583"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-584"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// determine the Mosfet ON time</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-585"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeON</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">abs</span><span class="crayon-sy">(</span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// make it alway a positive number</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-586">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-587"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">HIGH</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns Mosfet gate LOW = ON</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-588"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// time to give charge current to start and stabelize</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-589">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-590"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// Because the chargeCurrent is an AC current, more readings are taken and then averaged out</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-591">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-592"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">int</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// set, or reset, counter</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-593"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//reset averageAmpVoltage</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-594"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-595"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">ampReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-596"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">j</span><span class="crayon-o">++</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-597"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-598"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-599"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">periodTime</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-600"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-st">abs</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">currentZero</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">averageAmpVoltage</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-601"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ampere</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">currentADCRatio</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// convert ampVoltage to amperes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-602"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// reset cursor</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-603"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Current:"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-604"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">ampere</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-605"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">" Amp"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// print to LCD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-606">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-607"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">chargeON</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-608"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">digitalWrite</span><span class="crayon-sy">(</span><span class="crayon-v">transistorPin</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k">LOW</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// transistor turns off, Mosfet gate goes HIGH =&gt; OFF</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-609">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-610"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of if-statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-611">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-612">&nbsp;</div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-613"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">ampVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-v">battFullCurrentAnalog</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage12V</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-614"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">// if raw ampreading &lt;= battery full current and battery Voltage &gt;= floatVoltage</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-615">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-616"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">absorptionVoltage12V</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">floatVoltage12V</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// change absorption Voltage to float Voltage.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-617"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-618"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">home</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-619"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Float charge&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-620"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-v">setCursor</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-621"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Batt: "</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-622"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-v">batteryVoltage</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">conversionFactor12V</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-623"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">LCD</span><span class="crayon-sy">.</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"V&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-624"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">20</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-625">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-626"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-627"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">switchPosition</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">digitalRead</span><span class="crayon-sy">(</span><span class="crayon-v">modeSwitchPin</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">// check swithMode for changes</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-628"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">chargeVoltage</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-st">analogRead</span><span class="crayon-sy">(</span><span class="crayon-v">chargeReading</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-c">// check the chargeVoltage again for 6-12V chargeMode</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-629"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">delay</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// to allow anolagReading to settle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-630"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of else statement</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-631"><span class="crayon-c">//-----------------------------------End of 12V Absoption loop------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-632"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-c">// end of else statement.</span></div><div class="crayon-line" id="crayon-5d06ac425d25e448208373-633">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5d06ac425d25e448208373-634"><span class="crayon-sy">}</span><span class="crayon-c">// end of void-loop</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0532 seconds] -->
<p>The position of the external toggle switches determines whether 6Volt, 12Volt, absorption- or equalization-charge is selected.</p>
<p>The sketch feeds-back the selected switch position via indicator LED’s. Because the LED’s are an Arduino feedback of the choice made, it may take a little delay before the appropriate LED comes on.</p>
<p>The sketch recognizes, via the charge Voltage divider, which charge voltage is chosen.</p>
<p>If 12Volt is selected, but a 6Volt battery is connected, the LCD will show “Batt Volt Low” message.</p>
<p>If 6Volt is selected, but a 12Volt battery is connected, the LCD will show “Charge Volt Low” message.</p>
<p>As long as the charge-clamps are not connected to the battery, the LCD will show “Batt Volt Low” and the clamps remain “dead.” No change or shorting them.&nbsp;Only when the charge and battery voltages match will the charger start charging.</p>
<p>This also means that when attempting to charge a completely dead battery, which has a remaining voltage below a “healthy”-battery threshold, the charger may refuse to charge.</p>
<p>In such case, the charge thresholds can be altered in the sketch, but most likely the battery is already severely damaged.</p>
<p>Again, I like to refer to the comprehensive Victrons booklet “Energy-Unlimited” for battery Depth of Discharge and consequences.</p>
<p>When “Absorption” charge is selected (6V or 12V), the charger will bring the voltage level up to the voltage required for an absorption charge. It remains there until the current has dropped below a level at which the battery is considered full (See Victron ” Energy-Unlimited”). Hereafter, the charger will switch to Float-charge.</p>
<p>When Equalization mode is selected, the charger will bring the voltage level up to the voltage required for equalization charge.</p>
<p>It will remain there until the “operator” (you) decides enough equalization is done (see Victron ” Energy-Unlimited”).</p>
<p>Therefore, the Equalization charge needs constant attention and monitoring. During equalization charge, the batteries produce explosive hydrogen gases. This means no open-fire and ensure the charging is performed in a well-vented area.</p>
<p><a href="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC10.jpg" rel="attachment wp-att-5705"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PIC10.jpg" alt="Top view of Arduino Controlled Battery Charger" width="720" height="558" class="aligncenter size-full wp-image-5705" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC10.jpg 720w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/PIC10-300x233.jpg 300w" sizes="(max-width: 720px) 100vw, 720px"></a></p>
<p>Each type of battery has its own characteristics and manufacture recommended charge-voltages. Check the properties of your batteries and change them in the IDE sketch.</p>
<p>Once you understand how batteries work and follow correct charging procedures, it will prolong the battery life considerably.</p>
<p>Batteries look robust on the outside, but for a long life, you have to treat them with velvet gloves.</p>
<p>Work safe on the mains. Preferably you should use an isolation transformer in combination with a Variac.</p>
<p><strong>Any suggestions / improvements are very welcome – please leave your comments!</strong></p>
<p>RvD.</p>
<h2>Further Reading:</h2>
<p>A highly recommended read about Lead-Acid-Battery charging: <a href="http://www.victronenergy.dk/upload/documents/Book-Energy-Unlimited-EN.pdf" target="_blank">http://www.victronenergy.dk/upload/documents/Book-Energy-Unlimited-EN.pdf</a></p>
<p>Lewis Loflins Website:&nbsp;<a href="http://www.bristolwatch.com/solar1.htm" target="_blank">http://www.bristolwatch.com/solar1.htm&nbsp;</a></p>
<h2>Downloads:</h2>
<p><a href="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2015/12/Arduino-Controlled-Battery-Charger.zip" rel="">Click here to download a zip file of the schematics and Arduino code for this project.</a></p>
<div id="popup-embedded-box-pro-gfcr-5" role-placeholder-kjdshe="" class="popup-embedded-box-pro-gfcr-5 popupally-pro-outer-full-width-5-fluid_abdess class-placeholder-jehjsq-5"><div class="popupally-pro-outer-embedded-5-fluid_abdess"><form action="https://programmingelectronics.com/arduino-controlled-battery-charger/" method="post" sejds-popupally-pro-anti-spam-uengs="hts/frsotaotcmv./ompoesrpp" qweokgj-popupally-pro-anti-spam-mwhgser="tp:/om.nrpr.o/24fr_rcso.h?" popupally-pro-embed="5" class="popupallypro-signup-form-sijfhw popupally-pro-inner-5-fluid_abdess"><input type="hidden" name="afft_" value=""><input type="hidden" name="aff_" value=""><input type="hidden" name="sess_" value=""><input type="hidden" name="ref_" value=""><input type="hidden" name="own_" value=""><input type="hidden" name="oprid" value=""><input type="hidden" name="contact_id" value=""><input type="hidden" name="utm_source" value=""><input type="hidden" name="utm_medium" value=""><input type="hidden" name="utm_term" value=""><input type="hidden" name="utm_content" value=""><input type="hidden" name="utm_campaign" value=""><input type="hidden" name="referral_page" value=""><input type="hidden" name="uid" value="p2c30397f89"><input type="hidden" name="uniquep2c30397f89" value="0"><input type="hidden" name="mopsbbk" value="AED6FB27292074D50862EF6A:9DBCA8A4C853B32B10334C6E"><input type="hidden" name="lastname" value=""><div id="popupally-fluid-5-fluid_abdess-1" class="popupally-fluid-content-element">Want to get your Arduino project up and running?</div><div id="popupally-fluid-5-fluid_abdess-2" class="popupally-fluid-content-element">Get instant access to the Arduino Crash Course, a 12 lesson video training curriculum that teaches the details of Arduino programming and electronics and doesn’t assume you have a PhD.</div><input id="popupally-fluid-5-fluid_abdess-3" type="text" name="firstname" required="required" class="popupally-fluid-content-element" placeholder="FIRST NAME"><input id="popupally-fluid-5-fluid_abdess-5" type="email" name="email" required="required" class="popupally-fluid-content-element" placeholder="EMAIL"><input id="popupally-fluid-5-fluid_abdess-6" type="submit" class="popupally-fluid-content-element" value="GET ACCESS"><div id="popupally-fluid-5-fluid_abdess-7" class="popupally-fluid-content-element">You will receive email correspondence about Arduino programming, electronics, and special offers. By submitting this form you agree to the <a href="https://programmingelectronics.typeform.com/to/Dgv6JG" target="_blank">privacy policy</a>, and can opt-out anytime.</div><div id="popupally-fluid-5-fluid_abdess-8" class="popupally-fluid-content-element"></div></form></div></div>	</div>
</div>
<div class="fl-module fl-module-separator fl-node-5ba1491146d36" data-node="5ba1491146d36">
	<div class="fl-module-content fl-node-content">
		<div class="fl-separator"></div>
	</div>
</div>
<div class="fl-module fl-module-fl-comments fl-node-5ba1491146cb8" data-node="5ba1491146cb8">
	<div class="fl-module-content fl-node-content">
		<div class="fl-comments">

	
		<div class="fl-comments-list">

		<h3 class="fl-comments-list-title">
			13 Comments		</h3>

		<ol id="comments">
		<li class="comment even thread-even depth-1" id="li-comment-4455">
	<div id="comment-4455" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Jim Greever</span> <span class="comment-date">on January 3, 2016 at 11:31 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>This is an excellent project!<br>
I’m very pleased that you clearly documented everything you did.<br>
Thank you for sharing.</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4455" data-commentid="4455" data-postid="5697" data-belowelement="comment-4455" data-respondelement="respond" aria-label="Reply to Jim Greever">Reply</a></div>
	</div><!-- .comment-body -->
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-4456">
	<div id="comment-4456" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/108182d6b4ab8ecc56fe5593e3034d0a.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link"><a href="http://www.opensourcehardwaregroup.com/" rel="external nofollow" class="url">MICHAEL JAMES</a></span> <span class="comment-date">on January 4, 2016 at 2:00 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>I thought the same thing – the documentation is fantastic!  There more more pictures too that I didn’t post, but the quality is fantastic.</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4456" data-commentid="4456" data-postid="5697" data-belowelement="comment-4456" data-respondelement="respond" aria-label="Reply to MICHAEL JAMES">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-4461">
	<div id="comment-4461" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Jack Singler</span> <span class="comment-date">on February 16, 2016 at 6:53 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>I’m just a little confused as to how you hooked up A0, A1, A2 pins in your circuit? I understand they’re used for analog readings but how are they hooked up in the circuit? Thanks many if you can enlighten us,</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4461" data-commentid="4461" data-postid="5697" data-belowelement="comment-4461" data-respondelement="respond" aria-label="Reply to Jack Singler">Reply</a></div>
	</div><!-- .comment-body -->
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-4462">
	<div id="comment-4462" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Jack Singler</span> <span class="comment-date">on February 16, 2016 at 7:10 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Also, how did you know to use those certain resistor values and how did you get the ADC conversion values? Much appreciated</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4462" data-commentid="4462" data-postid="5697" data-belowelement="comment-4462" data-respondelement="respond" aria-label="Reply to Jack Singler">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment even depth-2" id="li-comment-4463">
	<div id="comment-4463" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/108182d6b4ab8ecc56fe5593e3034d0a.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link"><a href="http://www.opensourcehardwaregroup.com/" rel="external nofollow" class="url">MICHAEL JAMES</a></span> <span class="comment-date">on February 17, 2016 at 12:13 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>This is from Roland….</p>
<p>Hello Jack; I’ll take it that you downloaded the zip-file with all the schematics? If you take in the sketch for example #define chargeReading Aø, which means that analog pin ø dedicated to chargeReading. In this case it reads to output of the voltage divider on the charge side. If you look in the schematic, there is “pointer” saying “chargeReading” and facing outwards, meaning an output. That’s the one going to the Aø pin. Maybe I could have given each output / Input in the schematic a fixed Arduino pin, but I wanted to give the builder the liberty to choose their own Arduino pins.</p>
<p>The schematic shows “chargeReading”, an output going out to the Arduino board. You can see in the sketch “chargeReading” goes to Aø.</p>
<p>Another example; A little lower in the schematic you see “zenerBypassPin”, which is a pointer as an input to the schematic, so for the an Arduino it’s an output. Look in the sketch and “zenerBypassPin” is 11. If you look in the void setup(), you see that the pinMode (zenerBypassPin, OUTPUT);</p>
<p>Pointers facing towards the schematic is an input from the Arduinoboard, pointers facing outwards from the schematic are outputs, so inputs for the Arduino board.</p>
<p>As for the voltage dividers; assume the highest anticipated voltage on the Main DC power rail is 25V and in this case the maximum voltage on your Arduino analog input pin should not be higher then the voltage reference of 3.3V. I took a 1kΩ resistor, with 3.3V you get 3.3mA. To calculate the other resistor: (25-3.3) / 0.0033 = 6.57 kΩ. This one doesn’t exist, so I took the next higher = 6.8kΩ.</p>
<p>As for the ADC conversions values; I’ll take it that you are talking about the current? With a known current flowing through the Hall-sensor, you read the ADC reading via the serial-monitor. You take several different current readings, so you get different ADC readings. This you can plot and should be a reasonable linear line. From the angle of the line, you can calculate the conversion factor, or by just looking at the numbers…… all mathematics <img draggable="false" class="emoji" alt="🙂" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1f642.svg"></p>
<p>Hope this helps……..</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4463" data-commentid="4463" data-postid="5697" data-belowelement="comment-4463" data-respondelement="respond" aria-label="Reply to MICHAEL JAMES">Reply</a></div>
	</div><!-- .comment-body -->
<ul class="children">
<li class="comment odd alt depth-3" id="li-comment-4464">
	<div id="comment-4464" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Jack Singler</span> <span class="comment-date">on February 21, 2016 at 6:48 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Wow thanks for the answer, that clears it up !</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4464" data-commentid="4464" data-postid="5697" data-belowelement="comment-4464" data-respondelement="respond" aria-label="Reply to Jack Singler">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-4466">
	<div id="comment-4466" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Helio</span> <span class="comment-date">on February 25, 2016 at 10:11 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Hi, very well documented project, thanks for sharing. I was looking through the code and I wasn’t clear about one if statement </p>
<p>if (ampVoltage = absorptionVoltage12V &amp;&amp; chargeVoltage &gt;= floatVoltage12V)</p>
<p>When will this condition, i.e. batteryVoltage &gt;= absorptionVoltage12V, ever be met? Even if the battery is at full charge won’t its Voltage be at a little bit above 12V?</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4466" data-commentid="4466" data-postid="5697" data-belowelement="comment-4466" data-respondelement="respond" aria-label="Reply to Helio">Reply</a></div>
	</div><!-- .comment-body -->
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-4471">
	<div id="comment-4471" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/108182d6b4ab8ecc56fe5593e3034d0a.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link"><a href="http://www.opensourcehardwaregroup.com/" rel="external nofollow" class="url">MICHAEL JAMES</a></span> <span class="comment-date">on March 11, 2016 at 1:39 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>This is from Roland:</p>
<p>Yes that condition will be met when.</p>
<p>Condition 1) ampVoltage is the Voltage from the current-sensor, battFullCurrentAnalog is the converted number of thebattFullCurrent. So the condition is; if the real current flowing is lower, or equal, than the set battFullCurrent, then the battery if considered to be full</p>
<p>Condition 2) batteryVoltage &gt;= absorptionVoltage12V. Please note that absorptionVoltage12V is just a name to indicate that we are in the 12V mode, and has nothing to do with exactly 12Volt. The absorption voltage for my batteries is 14.8Volt, as you can read in the initialization of the parameters. So what the condition says; if the battery voltage is bigger than the set absorption Voltage, then the battery is considered full.</p>
<p>Condition 3) chargeVoltage &gt;= floatVoltage12V. This nearly always the case when is everything works fine. It is just that when switching over to the float-charge, the charge-voltage has to be bigger than the float-voltage……..Duh…..</p>
<p>So when all three conditions are met, the absorptionVoltage12V will be set equal to the floatVoltage12V and the charger will go in float-mode. Again, both “12V” have nothing to do with the actual absorption- or float-voltages</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4471" data-commentid="4471" data-postid="5697" data-belowelement="comment-4471" data-respondelement="respond" aria-label="Reply to MICHAEL JAMES">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-4467">
	<div id="comment-4467" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Jack Singler</span> <span class="comment-date">on March 3, 2016 at 8:00 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Hi Roland I have another question, </p>
<p>how did you for instance figure out “int lowCutOffVoltage12V = 455” how is this equivalent to 11.5V? Or I guess the more relevant question is how did you figure out the “float conversionFactor12V = 0.02525”. I get that 455*0.02525 = 11.5V but I don’t understand how you came up with that conversion factor?</p>
<p>And I’m still confused as to how you figured out “float currentADCRatio = 16.735” :/ I understand “int currentZero = 514” is just the serial print output of when no current is flowing but i don’t understand the 16.735 value?</p>
<p>I appreciate you taking the time to answer this if you can.</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4467" data-commentid="4467" data-postid="5697" data-belowelement="comment-4467" data-respondelement="respond" aria-label="Reply to Jack Singler">Reply</a></div>
	</div><!-- .comment-body -->
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-4470">
	<div id="comment-4470" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/108182d6b4ab8ecc56fe5593e3034d0a.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link"><a href="http://www.opensourcehardwaregroup.com/" rel="external nofollow" class="url">MICHAEL JAMES</a></span> <span class="comment-date">on March 11, 2016 at 1:38 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>This is from Roland:</p>
<p>What I have done is to set with a bench power supply a specific voltage and the main DC rail; say 11.5V. You can read out from the serial monitor what number you get from the voltage divider(s), which was 455. So 11.5V = 455. Assuming all is a linear line (which it was not), then 11.5 / 455 = 0.02525</p>
<p>What I noticed is when in the 6V range these conversion factors were not exactly the same as 12V and above. To get the voltage readout as accurate as possible, I took two conversion factors, one for 6V range and one for the 12V range. Don’t ask me why there is a deviation…….</p>
<p>As for the current readout and conversion factors; I did the same. I took the bench power supply, a multi-meter and a big resistor. The resistors happen to be two old electrical grill out of an oven (25 Ohm) and some 6 Ohm 50Watt resistors. By putting them in series or parallel, you can create all sorts of resistance.  Obviously you feed this current through the hall-sensor and take read-outs on your serial monitor. When you increase the voltage, the current increases and you calibrate the number on the serial monitor with the amps showing on your multi-meter. So you calibrate against your multi-meter; assuming your multi-meter is accurate (enough). The resistors are getting hot, so you don’t have much time to hang around at different settings. My bench power supply couldn’t go higher then 3 Amps, but since the hall sensor is linear, higher currents are therefor extrapolated. Also, higher currents are just more for an indication. Whether the battery charges with 6, 7,8 or 10 Amps….. not so exiting. All you are really interested in is the current when the battery is considered to be full, or battFullCurrent. Batteries are more sensitive to voltage than to current, so accurate voltage readouts are more important.</p>
<p>I can’t repeat the conversion factors I got, as that would mean that I have to make a complete setup up as described above and take the charger apart. Hope I guided you in the direction and as long as you keep tinkering, I hope you get the conversion factors <img draggable="false" class="emoji" alt="😉" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/1f609.svg"></p>
<p>Regards: Roland.</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4470" data-commentid="4470" data-postid="5697" data-belowelement="comment-4470" data-respondelement="respond" aria-label="Reply to MICHAEL JAMES">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-4489">
	<div id="comment-4489" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/283f22e3d675840e10618aae2d18fa9e.jpeg" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Daniele Senatore</span> <span class="comment-date">on June 6, 2016 at 5:08 pm</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Hello!<br>
First of all, thank you for sharing this wonderful project.<br>
I have a question about the transformer: where do you have found a transformer with that outputs? I think it have to be with 18V and 9V outputs, but I didn’t find it. Can you help me?<br>
Thank you in advance.<br>
Daniele</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4489" data-commentid="4489" data-postid="5697" data-belowelement="comment-4489" data-respondelement="respond" aria-label="Reply to Daniele Senatore">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-4513">
	<div id="comment-4513" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Reyad Haddad</span> <span class="comment-date">on September 30, 2016 at 4:30 am</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>Very Nice Project. From what I read this can charge batteries at 5A. How can I increase that to 10A or Even 15?</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4513" data-commentid="4513" data-postid="5697" data-belowelement="comment-4513" data-respondelement="respond" aria-label="Reply to Reyad Haddad">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-4599">
	<div id="comment-4599" class="comment-body clearfix">

		<div class="comment-meta">
			<span class="comment-avatar">
				<img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/grey-flavicon-150x150.png" width="80" height="80" alt="Avatar" class="avatar avatar-80wp-user-avatar wp-user-avatar-80 alignnone photo avatar-default">			</span>
			<span class="comment-author-link">Debasis Chakraborty</span> <span class="comment-date">on August 4, 2017 at 1:53 am</span>
		</div><!-- .comment-meta -->

		<div class="comment-content clearfix">
						<p>How can be modify the battery charger to support 24V 30-40 Ampere Charging or 72 V 40 Ampere charging. Please if you could change and send me the schematics, it will be quite helpful.</p>
					</div><!-- .comment-content -->

		<div class="comment-reply-link"><a rel="nofollow" class="comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#comment-4599" data-commentid="4599" data-postid="5697" data-belowelement="comment-4599" data-respondelement="respond" aria-label="Reply to Debasis Chakraborty">Reply</a></div>
	</div><!-- .comment-body -->
</li><!-- #comment-## -->
		</ol>

		
	</div>
			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://programmingelectronics.com/arduino-controlled-battery-charger/#respond" style="display:none;">Cancel Reply</a></small></h3>			<form action="https://programmingelectronics.com/wp-comments-post.php?wpe-comment-post=peacademy" method="post" id="fl-comment-form" class="fl-comment-form">
				<label for="comment">Comment</label><textarea name="comment" class="form-control" cols="60" rows="8" tabindex="4"></textarea><br><label for="author">Name (required)</label>
									<input type="text" name="author" class="form-control" value="" tabindex="1" aria-required="true"><br>
<label for="email">Email (will not be published) (required)</label>
									<input type="text" name="email" class="form-control" value="" tabindex="2" aria-required="true"><br>
<label for="url">Website</label>
									<input type="text" name="url" class="form-control" value="" tabindex="3"><br>
<p class="form-submit"><input name="submit" type="submit" id="fl-comment-form-submit" class="btn btn-primary" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="5697" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="c166d5194f"></p><p style="display: none;"></p>			</form>
			</div><!-- #respond -->
		</div>
	</div>
</div>
	</div>
</div>
	</div>
		</div>
	</div>
</div>
</div>
	</div><!-- .fl-page-content -->
	<footer class="fl-builder-content fl-builder-content-7979 fl-builder-global-templates-locked" data-post-id="7979" itemscope="itemscope" itemtype="http://schema.org/WPFooter" data-type="footer"><div id="footer-triangle-row" class="fl-row fl-row-full-width fl-row-bg-photo fl-node-5b365a7fa14f0" data-node="5b365a7fa14f0">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content">
		
<div class="fl-col-group fl-node-5b365a7fa77e8" data-node="5b365a7fa77e8">
			<div class="fl-col fl-node-5b365a7fa79a2 fl-col-has-cols" data-node="5b365a7fa79a2">
	<div class="fl-col-content fl-node-content">
	
<div class="fl-col-group fl-node-5b368c9b8ee58 fl-col-group-nested" data-node="5b368c9b8ee58">
			<div class="fl-col fl-node-5b368c9b8f0f6" data-node="5b368c9b8f0f6">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-rich-text fl-node-5b368cb63a940" data-node="5b368cb63a940">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<h3 style="text-align: center;">Proud supporters of</h3>
<p style="padding-top: 10px;"><img class="aligncenter size-medium wp-image-7993" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/First-Robotics-Competition-300x70.png" alt="First Robotics Competition" width="300" height="70" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/First-Robotics-Competition-300x70.png 300w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/First-Robotics-Competition.png 301w" sizes="(max-width: 300px) 100vw, 300px"></p>
</div>
	</div>
</div>
	</div>
</div>
	</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b3f897ee83f6" data-node="5b3f897ee83f6">
			<div class="fl-col fl-node-5b3f897ee8786" data-node="5b3f897ee8786">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-rich-text fl-node-5b36947babe85 pea-logo-heading" data-node="5b36947babe85">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<h3 style="text-align: center;">Subscribers From</h3>
</div>
	</div>
</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b3f8cbb36e84" data-node="5b3f8cbb36e84">
			<div class="fl-col fl-node-5b3f8cbb3714c fl-col-small" data-node="5b3f8cbb3714c">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b368de6c35b1 pea-logo-home" data-node="5b368de6c35b1">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8031 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Sultan-School-Disctrict.png" alt="Sultan School District" itemprop="image" height="316" width="704" title="Sultan School District" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Sultan-School-Disctrict.png 704w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Sultan-School-Disctrict-300x135.png 300w" sizes="(max-width: 704px) 100vw, 704px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8cbb37191 fl-col-small" data-node="5b3f8cbb37191">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b3694a757031 pea-logo-home" data-node="5b3694a757031">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8028 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Childrens-Museum-of-Indianoplis.png" alt="Childrens Museum of Indianoplis" itemprop="image" height="100" width="149" title="Childrens Museum of Indianoplis">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8cbb371d0 fl-col-small" data-node="5b3f8cbb371d0">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b368fd444ed3 pea-logo-home" data-node="5b368fd444ed3">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8034 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Univeristy-of-Akron.png" alt="Univeristy of Akron" itemprop="image" height="93" width="172" title="Univeristy of Akron">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8cbb3720f fl-col-small" data-node="5b3f8cbb3720f">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b368fffaafc9 pea-logo-home" data-node="5b368fffaafc9">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8030 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Quinsigamond-Community-College.png" alt="Quinsigamond Community College" itemprop="image" height="231" width="800" title="Quinsigamond Community College" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Quinsigamond-Community-College.png 800w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Quinsigamond-Community-College-300x87.png 300w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Quinsigamond-Community-College-768x222.png 768w" sizes="(max-width: 800px) 100vw, 800px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8cbb3724d fl-col-small" data-node="5b3f8cbb3724d">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b368fece867e pea-logo-home" data-node="5b368fece867e">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8032 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/WORCESTER-TECHNICAL-HIGH-SCHOOL.png" alt="WORCESTER TECHNICAL HIGH SCHOOL" itemprop="image" height="210" width="554" title="WORCESTER TECHNICAL HIGH SCHOOL" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/WORCESTER-TECHNICAL-HIGH-SCHOOL.png 554w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/WORCESTER-TECHNICAL-HIGH-SCHOOL-300x114.png 300w" sizes="(max-width: 554px) 100vw, 554px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8cbb3728c fl-col-small" data-node="5b3f8cbb3728c">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b368feaf413e pea-logo-home" data-node="5b368feaf413e">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8037 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/North-East-Metropolitan-Regional-Vocational-School_sm.png" alt="North East Metropolitan Regional Vocational School" itemprop="image" height="131" width="130" title="North East Metropolitan Regional Vocational School">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b3f89c567c58" data-node="5b3f89c567c58">
			<div class="fl-col fl-node-5b3f89c567f79" data-node="5b3f89c567f79">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-rich-text fl-node-5b3694e853e6f pea-logo-heading" data-node="5b3694e853e6f">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<h3 style="text-align: center;">As seen in</h3>
</div>
	</div>
</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b3f8ce38adf7" data-node="5b3f8ce38adf7">
			<div class="fl-col fl-node-5b3f8ce38b157 fl-col-small" data-node="5b3f8ce38b157">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b3692c0cebd8 pea-logo-home2" data-node="5b3692c0cebd8">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8155 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/ADAFRUITLOGO.png" alt="adafruit logo" itemprop="image" height="196" width="573" title="ADAFRUITLOGO" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/ADAFRUITLOGO.png 573w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/ADAFRUITLOGO-300x103.png 300w" sizes="(max-width: 573px) 100vw, 573px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8ce38b1ba fl-col-small" data-node="5b3f8ce38b1ba">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b36929ea610c pea-logo-home2" data-node="5b36929ea610c">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8024 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/Dr-Duino.png" alt="Dr Duino" itemprop="image" height="82" width="349" title="Dr Duino" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Dr-Duino.png 349w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/Dr-Duino-300x70.png 300w" sizes="(max-width: 349px) 100vw, 349px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8ce38b212 fl-col-small" data-node="5b3f8ce38b212">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b3692d7e3f47 pea-logo-home2" data-node="5b3692d7e3f47">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8027 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/TinyCircuit.png" alt="Tiny Circuits" itemprop="image" height="138" width="400" title="Tiny Circuits" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/TinyCircuit.png 400w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/TinyCircuit-300x104.png 300w" sizes="(max-width: 400px) 100vw, 400px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8ce38b26b fl-col-small" data-node="5b3f8ce38b26b">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b3692f810662 pea-logo-home2" data-node="5b3692f810662">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8156 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/ScopeIT_Transparaent.00_png_srz.png" alt="ScopeIT logo" itemprop="image" height="110" width="306" title="ScopeIT_Transparaent.00_png_srz" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/ScopeIT_Transparaent.00_png_srz.png 306w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/ScopeIT_Transparaent.00_png_srz-300x108.png 300w" sizes="(max-width: 306px) 100vw, 306px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8ce38b2c7 fl-col-small" data-node="5b3f8ce38b2c7">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-photo fl-node-5b3693152baac pea-logo-home2" data-node="5b3693152baac">
	<div class="fl-module-content fl-node-content">
		<div class="fl-photo fl-photo-align-center" itemscope="" itemtype="https://schema.org/ImageObject">
	<div class="fl-photo-content fl-photo-img-png">
				<img class="fl-photo-img wp-image-8182 size-full" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/MJLorton-Logo.png" alt="MJLorton" itemprop="image" height="58" width="310" title="MJLorton Logo" srcset="https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/MJLorton-Logo.png 310w, https://4c3q4z2euxqn29mk0e34ayce-wpengine.netdna-ssl.com/wp-content/uploads/2018/06/MJLorton-Logo-300x56.png 300w" sizes="(max-width: 310px) 100vw, 310px">
					</div>
	</div>
	</div>
</div>
	</div>
</div>
			<div class="fl-col fl-node-5b3f8ce38b30c fl-col-small" data-node="5b3f8ce38b30c">
	<div class="fl-col-content fl-node-content">
		</div>
</div>
	</div>
		</div>
	</div>
</div>
<div class="fl-row fl-row-full-width fl-row-bg-color fl-node-5b364dfeb8c48" data-node="5b364dfeb8c48">
	<div class="fl-row-content-wrap">
						<div class="fl-row-content fl-row-fixed-width fl-node-content" style="position: relative;">
		
<div class="fl-col-group fl-node-5b364dfec1ffc" data-node="5b364dfec1ffc">
			<div class="fl-col fl-node-5b364dfec2286" data-node="5b364dfec2286">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-menu fl-node-5b364e1c64226" data-node="5b364e1c64226">
	<div class="fl-module-content fl-node-content">
		<div class="fl-menu fl-menu-responsive-toggle-mobile">
	<button class="fl-menu-mobile-toggle text"><span class="fl-menu-mobile-toggle-label" aria-label="Menu">Menu</span></button>	<div class="fl-clear"></div>
	<nav aria-label="Menu" itemscope="itemscope" itemtype="https://schema.org/SiteNavigationElement"><ul id="menu-footer-menu" class="menu fl-menu-horizontal fl-toggle-none"><li id="menu-item-8177" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/arduino-crash-course/">Free Arduino Course</a></li><li id="menu-item-8179" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/kit-shield-arduino-info/">Arduino Shield</a></li><li id="menu-item-8180" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/pricing-archive/">Courses</a></li><li id="menu-item-8181" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/about/">About</a></li><li id="menu-item-7985" class="menu-item menu-item-type-post_type menu-item-object-page"><a href="https://programmingelectronics.com/contact/">Contact</a></li></ul></nav></div>
	</div>
</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b3659697b2aa" data-node="5b3659697b2aa">
			<div class="fl-col fl-node-5b3659697b4d8" data-node="5b3659697b4d8">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-rich-text fl-node-5b368a01021a9" data-node="5b368a01021a9">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<p style="text-align: center; padding-top: 15px; margin-bottom: 0;"><a href="https://www.youtube.com/c/Opensourcehardwaregroup" target="_blank"><img class="alignnone size-full wp-image-7988" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PE_YouTube.png" alt="YouTube" width="40" height="40"></a><a href="https://www.facebook.com/ProgrammingElectronicsAcademy/" target="_blank"><img class="alignnone size-full wp-image-7987" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PE_Facebook.png" alt="Facebook" width="40" height="40"></a><a href="https://twitter.com/ProgElecAcademy" target="_blank"><img class="alignnone size-full wp-image-7986" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PE_Twitter.png" alt="Twitter" width="40" height="40"></a></p>
</div>
	</div>
</div>
<div class="fl-module fl-module-rich-text fl-node-5b3659697b140" data-node="5b3659697b140">
	<div class="fl-module-content fl-node-content">
		<div class="fl-rich-text">
	<p class="pea-copyright">© 2019 OPEN HARDWARE DESIGN GROUP LLC | <a href="https://programmingelectronics.com/privacy-policy">PRIVACY POLICY</a></p>
</div>
	</div>
</div>
	</div>
</div>
	</div>

<div class="fl-col-group fl-node-5b365078492ec" data-node="5b365078492ec">
			<div class="fl-col fl-node-5b365078496a6" data-node="5b365078496a6">
	<div class="fl-col-content fl-node-content">
	<div class="fl-module fl-module-html fl-node-5b36507df19c1" data-node="5b36507df19c1">
	<div class="fl-module-content fl-node-content">
		<div class="fl-html">
	<div style="text-align: center;"><a href="https://www.bbb.org/cleveland/business-reviews/training-program/programming-electronics-academy-in-ashtabula-oh-92021031/#sealclick" target="_blank" rel="nofollow"><img src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/blue-seal-280-80-bbb-92021031.png" style="border: 0;" alt="Programming Electronics Academy BBB Business Review"></a></div></div>
	</div>
</div>
	</div>
</div>
	</div>
		</div>
	</div>
</div>
</footer>	</div><!-- .fl-page -->
<div id="popup-box-pro-gfcr-5" class="popupally-pro-overlay-5-fluid_abdess popup-click-close-trigger-5"><div class="popupally-pro-outer-full-width-5-fluid_abdess"><div class="popupally-pro-outer-5-fluid_abdess"><form action="https://programmingelectronics.com/arduino-controlled-battery-charger/" method="post" sejds-popupally-pro-anti-spam-uengs="hts/frsotaotcmv./ompoesrpp" qweokgj-popupally-pro-anti-spam-mwhgser="tp:/om.nrpr.o/24fr_rcso.h?" popupally-pro-popup="5" class="popupallypro-signup-form-sijfhw popupally-pro-inner-5-fluid_abdess"><input type="hidden" name="afft_" value=""><input type="hidden" name="aff_" value=""><input type="hidden" name="sess_" value=""><input type="hidden" name="ref_" value=""><input type="hidden" name="own_" value=""><input type="hidden" name="oprid" value=""><input type="hidden" name="contact_id" value=""><input type="hidden" name="utm_source" value=""><input type="hidden" name="utm_medium" value=""><input type="hidden" name="utm_term" value=""><input type="hidden" name="utm_content" value=""><input type="hidden" name="utm_campaign" value=""><input type="hidden" name="referral_page" value=""><input type="hidden" name="uid" value="p2c30397f89"><input type="hidden" name="uniquep2c30397f89" value="0"><input type="hidden" name="mopsbbk" value="AED6FB27292074D50862EF6A:9DBCA8A4C853B32B10334C6E"><input type="hidden" name="lastname" value=""><div id="popupally-fluid-5-fluid_abdess-1" class="popupally-fluid-content-element">Want to get your Arduino project up and running?</div><div id="popupally-fluid-5-fluid_abdess-2" class="popupally-fluid-content-element">Get instant access to the Arduino Crash Course, a 12 lesson video training curriculum that teaches the details of Arduino programming and electronics and doesn’t assume you have a PhD.</div><input id="popupally-fluid-5-fluid_abdess-3" type="text" name="firstname" required="required" class="popupally-fluid-content-element" placeholder="FIRST NAME"><input id="popupally-fluid-5-fluid_abdess-5" type="email" name="email" required="required" class="popupally-fluid-content-element" placeholder="EMAIL"><input id="popupally-fluid-5-fluid_abdess-6" type="submit" class="popupally-fluid-content-element" value="GET ACCESS"><div id="popupally-fluid-5-fluid_abdess-7" class="popupally-fluid-content-element">You will receive email correspondence about Arduino programming, electronics, and special offers. By submitting this form you agree to the <a href="https://programmingelectronics.typeform.com/to/Dgv6JG" target="_blank">privacy policy</a>, and can opt-out anytime.</div><div id="popupally-fluid-5-fluid_abdess-8" class="popupally-fluid-content-element"></div></form><div title="Close" class="popupally-pro-close popup-click-close-trigger-5"></div></div></div></div><div id="popup-box-pro-gfcr-6" class="popupally-pro-overlay-6-fluid_abdess popup-click-close-trigger-6"><div class="popupally-pro-outer-full-width-6-fluid_abdess"><div class="popupally-pro-outer-6-fluid_abdess"><form action="https://programmingelectronics.com/arduino-controlled-battery-charger/" method="post" sejds-popupally-pro-anti-spam-uengs="hts/frsotaotcmv./ompoesrpp" qweokgj-popupally-pro-anti-spam-mwhgser="tp:/om.nrpr.o/24fr_rcso.h?" popupally-pro-popup="6" class="popupallypro-signup-form-sijfhw popupally-pro-inner-6-fluid_abdess"><input type="hidden" name="afft_" value=""><input type="hidden" name="aff_" value=""><input type="hidden" name="sess_" value=""><input type="hidden" name="ref_" value=""><input type="hidden" name="own_" value=""><input type="hidden" name="oprid" value=""><input type="hidden" name="contact_id" value=""><input type="hidden" name="utm_source" value=""><input type="hidden" name="utm_medium" value=""><input type="hidden" name="utm_term" value=""><input type="hidden" name="utm_content" value=""><input type="hidden" name="utm_campaign" value=""><input type="hidden" name="referral_page" value=""><input type="hidden" name="uid" value="p2c30397f90"><input type="hidden" name="uniquep2c30397f90" value="0"><input type="hidden" name="mopsbbk" value="7D37B0BE0896CEDC61A82E2C:D464E14CB4B7786CDB4F6DAF"><input type="hidden" name="lastname" value=""><div id="popupally-fluid-6-fluid_abdess-1" class="popupally-fluid-content-element">Want to get your Arduino project up and running?</div><div id="popupally-fluid-6-fluid_abdess-2" class="popupally-fluid-content-element">Get instant access to the Arduino Crash Course, a 12 lesson video training curriculum that teaches the details of Arduino programming and electronics and doesn’t assume you have a PhD.</div><input id="popupally-fluid-6-fluid_abdess-3" type="text" name="firstname" required="required" class="popupally-fluid-content-element" placeholder="FIRST NAME"><input id="popupally-fluid-6-fluid_abdess-5" type="email" name="email" required="required" class="popupally-fluid-content-element" placeholder="EMAIL"><input id="popupally-fluid-6-fluid_abdess-6" type="submit" class="popupally-fluid-content-element" value="GET ACCESS"><div id="popupally-fluid-6-fluid_abdess-7" class="popupally-fluid-content-element">You will receive email correspondence about Arduino programming, electronics, and special offers. By submitting this form you agree to the <a href="https://programmingelectronics.typeform.com/to/Dgv6JG" target="_blank">privacy policy</a>, and can opt-out anytime.</div><div id="popupally-fluid-6-fluid_abdess-8" class="popupally-fluid-content-element"></div></form><div title="Close" class="popupally-pro-close popup-click-close-trigger-6"></div></div></div></div><div id="popup-box-pro-gfcr-7" class="popupally-pro-overlay-7-fluid_abdess popup-click-close-trigger-7"><div class="popupally-pro-outer-full-width-7-fluid_abdess"><div class="popupally-pro-outer-7-fluid_abdess"><form action="https://programmingelectronics.com/arduino-controlled-battery-charger/" method="post" sejds-popupally-pro-anti-spam-uengs="hts/frsotaotcmv./ompoesrpp" qweokgj-popupally-pro-anti-spam-mwhgser="tp:/om.nrpr.o/24fr_rcso.h?" popupally-pro-popup="7" class="popupallypro-signup-form-sijfhw popupally-pro-inner-7-fluid_abdess"><input type="hidden" name="afft_" value=""><input type="hidden" name="aff_" value=""><input type="hidden" name="sess_" value=""><input type="hidden" name="ref_" value=""><input type="hidden" name="own_" value=""><input type="hidden" name="oprid" value=""><input type="hidden" name="contact_id" value=""><input type="hidden" name="utm_source" value=""><input type="hidden" name="utm_medium" value=""><input type="hidden" name="utm_term" value=""><input type="hidden" name="utm_content" value=""><input type="hidden" name="utm_campaign" value=""><input type="hidden" name="referral_page" value=""><input type="hidden" name="uid" value="p2c30397f91"><input type="hidden" name="uniquep2c30397f91" value="0"><input type="hidden" name="mopsbbk" value="2398F8CBED27104B01277508:331857C0DF091387AE3933F0"><input type="hidden" name="lastname" value=""><div id="popupally-fluid-7-fluid_abdess-1" class="popupally-fluid-content-element">Get FREE access to our video training that teaches how to program the Arduino.</div><div id="popupally-fluid-7-fluid_abdess-2" class="popupally-fluid-content-element">Get instant access to the Arduino Crash Course, a 12 lesson video training curriculum that teaches the details of Arduino programming and electronics and doesn’t assume you have a PhD.</div><input id="popupally-fluid-7-fluid_abdess-3" type="text" name="firstname" required="required" class="popupally-fluid-content-element" placeholder="FIRST NAME"><input id="popupally-fluid-7-fluid_abdess-5" type="email" name="email" required="required" class="popupally-fluid-content-element" placeholder="EMAIL"><input id="popupally-fluid-7-fluid_abdess-6" type="submit" class="popupally-fluid-content-element" value="GET ACCESS"><div id="popupally-fluid-7-fluid_abdess-7" class="popupally-fluid-content-element">You will receive email correspondence about Arduino programming, electronics, and special offers. By submitting this form you agree to the <a href="https://programmingelectronics.typeform.com/to/Dgv6JG" target="_blank">privacy policy</a>, and can opt-out anytime.</div><div id="popupally-fluid-7-fluid_abdess-8" class="popupally-fluid-content-element"></div></form><div title="Close" class="popupally-pro-close popup-click-close-trigger-7"></div></div></div></div><div id="popup-box-pro-gfcr-9" class="popupally-pro-overlay-9-fluid_abdess popup-click-close-trigger-9"><div class="popupally-pro-outer-full-width-9-fluid_abdess"><div class="popupally-pro-outer-9-fluid_abdess"><form action="https://programmingelectronics.com/arduino-controlled-battery-charger/" method="post" sejds-popupally-pro-anti-spam-uengs="hts/frsotaotcmv./ompoesrpp" qweokgj-popupally-pro-anti-spam-mwhgser="tp:/om.nrpr.o/24fr_rcso.h?" popupally-pro-popup="9" class="popupallypro-signup-form-sijfhw popupally-pro-inner-9-fluid_abdess"><input type="hidden" name="afft_" value=""><input type="hidden" name="aff_" value=""><input type="hidden" name="sess_" value=""><input type="hidden" name="ref_" value=""><input type="hidden" name="own_" value=""><input type="hidden" name="oprid" value=""><input type="hidden" name="contact_id" value=""><input type="hidden" name="utm_source" value=""><input type="hidden" name="utm_medium" value=""><input type="hidden" name="utm_term" value=""><input type="hidden" name="utm_content" value=""><input type="hidden" name="utm_campaign" value=""><input type="hidden" name="referral_page" value=""><input type="hidden" name="uid" value="p2c30397f92"><input type="hidden" name="uniquep2c30397f92" value="0"><input type="hidden" name="mopsbbk" value="5F3819AB55AEB792D49F8686:B665E0E501A62F6021DEDEFF"><input type="hidden" name="lastname" value=""><div id="popupally-fluid-9-fluid_abdess-1" class="popupally-fluid-content-element">You can learn this Arduino Stuff.  We can Help.</div><div id="popupally-fluid-9-fluid_abdess-2" class="popupally-fluid-content-element">Get access to our private training site.<br><br>You'll learn to program Arduino w/o searching the web for <s>hours</s> days.</div><input id="popupally-fluid-9-fluid_abdess-3" type="text" name="firstname" required="required" class="popupally-fluid-content-element" placeholder="FIRST NAME"><input id="popupally-fluid-9-fluid_abdess-5" type="email" name="email" required="required" class="popupally-fluid-content-element" placeholder="EMAIL"><input id="popupally-fluid-9-fluid_abdess-6" type="submit" class="popupally-fluid-content-element" value="GET ACCESS"><div id="popupally-fluid-9-fluid_abdess-7" class="popupally-fluid-content-element">You will receive email correspondence about Arduino programming, electronics, and special offers. By submitting this form you agree to the <a href="https://programmingelectronics.typeform.com/to/Dgv6JG" target="_blank">privacy policy</a>, and can opt-out anytime.</div><div id="popupally-fluid-9-fluid_abdess-8" class="popupally-fluid-content-element"></div></form><div title="Close" class="popupally-pro-close popup-click-close-trigger-9"></div></div></div></div>                        <script>
                            var html   = '<div id="sitelock_shield_logo" class="fixed_btm" style="bottom:15px;position:fixed;_position:absolute;width:117px;height:67px;right:15px;">';
                                html  += '<a href="https://www.sitelock.com/verify.php?site=programmingelectronics.com" onclick="window.open(\'https://www.sitelock.com/verify.php?site=programmingelectronics.com\',\'SiteLock\',\'width=600,height=600,left=160,top=170\');return false;">';
                                html  += '<img alt="malware removal and website security" title="SiteLock"  src="//shield.sitelock.com/shield/programmingelectronics.com" />';
                                html  += '</a>';
                                html  += '</div>';
                                
                            if ( document.body != null ) {
                                window.onload = function() {
                                    g = document.createElement('div');
                                    g.setAttribute( 'id', 'sitelock_shield_logo_placeholder' );
                                    document.body.appendChild( g );
                                    document.getElementById( 'sitelock_shield_logo_placeholder' ).innerHTML = html;
                                }
                            }
                        </script>
                    
		<!-- MonsterInsights Scroll Tracking -->
		<script type="text/javascript">
			if ( typeof(jQuery) !== 'undefined' ) {
				jQuery( document ).ready(function(){
					function monsterinsights_scroll_tracking_load() {
						if ( typeof(__gaTracker) !== 'undefined' && __gaTracker && __gaTracker.hasOwnProperty( "loaded" ) && __gaTracker.loaded == true ) {
							(function(factory) {
								if (typeof define === 'function' && define.amd) {
									// AMD
									define(['jquery'], factory);
								} else if (typeof module === 'object' && module.exports) {
									// CommonJS
									module.exports = factory(require('jquery'));
								} else {
									// Browser globals
									factory(jQuery);
								}
							}(function($) {

								/* Scroll Depth */
								"use strict";
								var defaults = {
									percentage: true
								};

								var $window = $(window),
									cache = [],
									scrollEventBound = false,
									lastPixelDepth = 0;

								/*
								 * Plugin
								 */

								$.scrollDepth = function(options) {

									var startTime = +new Date();

									options = $.extend({}, defaults, options);

									/*
									 * Functions
									 */

									function sendEvent(action, label, scrollDistance, timing) {

										var fieldsArray = {
											hitType       : 'event',
											eventCategory : 'Scroll Depth',
											eventAction   : action,
											eventLabel    : label,
											eventValue    : 1,
											nonInteraction: 1
										};

										MonsterInsightsObject.sendEvent( fieldsArray );
//										if (arguments.length > 2 && scrollDistance > lastPixelDepth) {
//											lastPixelDepth = scrollDistance;
//											fieldsArray = {
//												hitType       : 'event',
//												eventCategory : 'Scroll Depth',
//												eventAction   : 'Pixel Depth',
//												eventLabel    :  rounded(scrollDistance),
//												eventValue    : 1,
//												nonInteraction: 1
//											};
//											MonsterInsightsObject.sendEvent( fieldsArray );
//										}
										if (arguments.length > 3) {
											fieldsArray = {
												hitType        : 'timing',
												timingCategory : 'Scroll Depth',
												timingVar      : action,
												timingValue    : timing,
												timingLabel    : label,
												nonInteraction: 1
											};
											MonsterInsightsObject.sendEvent( fieldsArray );
										}
									}

									function calculateMarks(docHeight) {
										return {
											'25%' : parseInt(docHeight * 0.25, 10),
											'50%' : parseInt(docHeight * 0.50, 10),
											'75%' : parseInt(docHeight * 0.75, 10),
											// Cushion to trigger 100% event in iOS
											'100%': docHeight - 5
										};
									}

									function checkMarks(marks, scrollDistance, timing) {
										// Check each active mark
										$.each(marks, function(key, val) {
											if ( $.inArray(key, cache) === -1 && scrollDistance >= val ) {
												sendEvent('Percentage', key, scrollDistance, timing);
												cache.push(key);
											}
										});
									}

									function rounded(scrollDistance) {
										// Returns String
										return (Math.floor(scrollDistance/250) * 250).toString();
									}

									function init() {
										bindScrollDepth();
									}

									/*
									 * Public Methods
									 */

									// Reset Scroll Depth with the originally initialized options
									$.scrollDepth.reset = function() {
										cache = [];
										lastPixelDepth = 0;
										$window.off('scroll.scrollDepth');
										bindScrollDepth();
									};

									// Add DOM elements to be tracked
									$.scrollDepth.addElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.merge(options.elements, elems);

										// If scroll event has been unbound from window, rebind
										if (!scrollEventBound) {
											bindScrollDepth();
										}

									};

									// Remove DOM elements currently tracked
									$.scrollDepth.removeElements = function(elems) {

										if (typeof elems == "undefined" || !$.isArray(elems)) {
											return;
										}

										$.each(elems, function(index, elem) {

											var inElementsArray = $.inArray(elem, options.elements);
											var inCacheArray = $.inArray(elem, cache);

											if (inElementsArray != -1) {
												options.elements.splice(inElementsArray, 1);
											}

											if (inCacheArray != -1) {
												cache.splice(inCacheArray, 1);
											}

										});

									};

									/*
									 * Throttle function borrowed from:
									 * Underscore.js 1.5.2
									 * http://underscorejs.org
									 * (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
									 * Underscore may be freely distributed under the MIT license.
									 */

									function throttle(func, wait) {
										var context, args, result;
										var timeout = null;
										var previous = 0;
										var later = function() {
											previous = new Date;
											timeout = null;
											result = func.apply(context, args);
										};
										return function() {
											var now = new Date;
											if (!previous) previous = now;
											var remaining = wait - (now - previous);
											context = this;
											args = arguments;
											if (remaining <= 0) {
												clearTimeout(timeout);
												timeout = null;
												previous = now;
												result = func.apply(context, args);
											} else if (!timeout) {
												timeout = setTimeout(later, remaining);
											}
											return result;
										};
									}

									/*
									 * Scroll Event
									 */

									function bindScrollDepth() {

										scrollEventBound = true;

										$window.on('scroll.scrollDepth', throttle(function() {
											/*
											 * We calculate document and window height on each scroll event to
											 * account for dynamic DOM changes.
											 */

											var docHeight = $(document).height(),
												winHeight = window.innerHeight ? window.innerHeight : $window.height(),
												scrollDistance = $window.scrollTop() + winHeight,

												// Recalculate percentage marks
												marks = calculateMarks(docHeight),

												// Timing
												timing = +new Date - startTime;

											checkMarks(marks, scrollDistance, timing);
										}, 500));

									}

									init();
								};

								// UMD export
								return $.scrollDepth;

							}));

							jQuery.scrollDepth();
						} else {
							setTimeout(monsterinsights_scroll_tracking_load, 200);
						}
					}
					monsterinsights_scroll_tracking_load();
				});
			}
		</script>
		<!-- End MonsterInsights Scroll Tracking -->
		
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery.ba-throttle-debounce.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery.fitvids.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/a050779a1cb2feeaec3ab93fa1e4e1b6-layout-bundle.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/jquery.magnificpopup.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/comment-reply.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/bootstrap.min.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var themeopts = {"medium_breakpoint":"992","mobile_breakpoint":"768"};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/theme.min.js.descarga"></script>
<script type="text/javascript">
/* <![CDATA[ */
var fcaPcEvents = [];
var fcaPcDebug = {"debug":""};
var fcaPcPost = {"title":"Building my First Arduino Controlled Battery Charger :: Student Project","type":"post","id":"5697","categories":["Customer Projects"],"utm_support":"1","user_parameters":"1","edd_delay":"0","woo_delay":"0","edd_enabled":"","woo_enabled":""};
var fcaPcUserParams = {"referrer":"","language":"en-GB,en-US;q=0.9,en;q=0.8","logged_in":"false","post_tag":"","post_category":"Customer Projects"};
/* ]]> */
</script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/pixel-cat.min.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/wp-embed.min.js.descarga"></script>
<script async="async" type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/form.js.descarga"></script>
<script type="text/javascript" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/load.js.descarga" async=""></script>

<div id="someone-purchased" class="fomo-notification-position-bottom-left fomo-notification-animation-vertical fomo-notification-mobile-position-bottom fomo-notification-v2-gap fomo-notification fomo-notification-font-md fomo-notification-hide" style="cursor: pointer; margin-left: 0px; display: block;"><div class="fomo-notification-container" style="display:inline"><div style="display:inline" class="fomo-notification-image-wrapper"><div class="fomo-notification-image-wrapper-inside"><img onerror="document.getElementById(&#39;someone-purchased&#39;).className += &#39; fomo-notification-no-image&#39;;" class="fomo-notification-image " src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/PEA_Gear.png" style="cursor: pointer;"></div></div><div style="display:inline" class="fomo-notification-content-wrapper"><p class="fomo-notification-content"><strong>David</strong> in La Paz just signed up for the Arduino Crash Course <small></small></p></div><span id="fomo-close"></span></div></div><div id="sitelock_shield_logo_placeholder"><div id="sitelock_shield_logo" class="fixed_btm" style="bottom:15px;position:fixed;_position:absolute;width:117px;height:67px;right:15px;"><a href="https://www.sitelock.com/verify.php?site=programmingelectronics.com" onclick="window.open(&#39;https://www.sitelock.com/verify.php?site=programmingelectronics.com&#39;,&#39;SiteLock&#39;,&#39;width=600,height=600,left=160,top=170&#39;);return false;"><img alt="malware removal and website security" title="SiteLock" src="./Building my First Arduino Controlled Battery Charger __ Student Project - Programming Electronics Academy_files/programmingelectronics.com.descarga"></a></div></div></body></html>